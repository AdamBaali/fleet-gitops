- name: CIS - Ensure 'Allow Cortana Above Lock' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Cortana Above Lock' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search\\AllowCortanaAboveLock Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Windows Search\AllowCortanaAboveLock' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:session, requirement:standard, critical:false, control:allow-cortana-above-lock-is-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Prevent enabling lock screen camera' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Prevent enabling lock screen camera' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization\\NoLockScreenCamera Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Personalization\NoLockScreenCamera' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:prevent-enabling-lock-screen-camera-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Prevent enabling lock screen slide show' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Prevent enabling lock screen slide show' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization\\NoLockScreenSlideshow Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Personalization\NoLockScreenSlideshow' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:prevent-enabling-lock-screen-slide-show-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Configure SMB v1 server' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Configure SMB v1 server' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\\SMB1 Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters\SMB1' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:security, requirement:standard, critical:false, control:configure-smb-v1-server-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'WDigest Authentication' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'WDigest Authentication' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest\\UseLogonCredential Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest\UseLogonCredential' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:security, requirement:standard, critical:false, control:wdigest-authentication-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off multicast name resolution' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off multicast name resolution' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\DNSClient\\EnableMulticast Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\DNSClient\\EnableMulticast' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-multicast-name-resolution-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn on Mapper I/O (LLTDIO) driver' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn on Mapper I/O (LLTDIO) driver' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: LLTDIO Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'LLTDIO' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-on-mapper-i-o-lltdio-driver-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn on Responder (RSPNDR) driver' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn on Responder (RSPNDR) driver' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: RSPNDR Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'RSPNDR' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-on-responder-rspndr-driver-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Prohibit access of the Windows Connect Now wizards' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Prohibit access of the Windows Connect Now wizards' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\EnableWCNConfig Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\EnableWCNConfig' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:prohibit-access-of-the-windows-connect-now-wizards-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Print Spooler to accept client connections' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Print Spooler to accept client connections' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\EnablePrintSpoolerPromptingUI Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\EnablePrintSpoolerPromptingUI' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:printing, requirement:standard, critical:false, control:allow-print-spooler-to-accept-client-connections-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: "CIS - Ensure 'Configure RPC over TCP port: RPC over TCP port:' is set to 'Enabled: 0'"
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Configure RPC over TCP port: RPC over TCP port:' is set to 'Enabled: 0'. Expected state per CIS Intune benchmark: Enabled: 0."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc\\TcpPort Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc\\TcpPort' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:printing, requirement:standard, critical:false, control:configure-rpc-over-tcp-port-rpc-over-tcp-port-is-enabled-0, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Limits print driver installation to Administrators' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Limits print driver installation to Administrators' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\LimitDriverInstallationToAdministrators Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\LimitDriverInstallationToAdministrators' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:printing, requirement:standard, critical:false, control:limits-print-driver-installation-to-administrators-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off toast notifications on the lock screen (User)' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off toast notifications on the lock screen (User)' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: User Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'User' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-toast-notifications-on-the-lock-screen-user-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Include command line in process creation events' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Include command line in process creation events' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\ProcessCreationIncludeCmdLine_Enabled Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit\ProcessCreationIncludeCmdLine_Enabled' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:include-command-line-in-process-creation-events-is-enabled, cis_safeguard_id:CIS8.2
  purpose: Enforcement
- name: CIS - Ensure 'Prevent device metadata retrieval from the Internet' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Prevent device metadata retrieval from the Internet' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Device Metadata\\PreventDeviceMetadataFromNetwork Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Device Metadata\\PreventDeviceMetadataFromNetwork' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:prevent-device-metadata-retrieval-from-the-internet-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Continue experiences on this device' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Continue experiences on this device' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\EnableCdp Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\EnableCdp' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:continue-experiences-on-this-device-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off background refresh of Group Policy' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off background refresh of Group Policy' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\DisableBkGndGroupPolicy Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\DisableBkGndGroupPolicy' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-background-refresh-of-group-policy-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off access to the Store' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off access to the Store' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore\\DisableStoreApps Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore\\DisableStoreApps' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-access-to-the-store-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off downloading of print drivers over HTTP' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off downloading of print drivers over HTTP' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\DisableWebPnPDownload Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\DisableWebPnPDownload' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-downloading-of-print-drivers-over-http-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off printing over HTTP' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off printing over HTTP' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\DisableHTTPPrinting Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\DisableHTTPPrinting' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-printing-over-http-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off Search Companion content file updates' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off Search Companion content file updates' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\DisableSearchCompanionContentFileUpdates Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\DisableSearchCompanionContentFileUpdates' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-search-companion-content-file-updates-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off the "Order Prints" picture task' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off the \"Order Prints\" picture task' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\NoOrderPrints Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\NoOrderPrints' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-the-order-prints-picture-task-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off Windows Error Reporting' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off Windows Error Reporting' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting\\Disabled Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting\\Disabled' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-windows-error-reporting-is-enabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Block user from showing account details on sign-in' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Block user from showing account details on sign-in' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\BlockUserFromShowingAccountDetailsOnSignin Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\BlockUserFromShowingAccountDetailsOnSignin' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:block-user-from-showing-account-details-on-sign-in-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Do not display network selection UI' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Do not display network selection UI' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\DontDisplayNetworkSelectionUI Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\DontDisplayNetworkSelectionUI' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:do-not-display-network-selection-ui-is-enabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enumerate local users on domain-joined computers' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enumerate local users on domain-joined computers' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\EnumerateLocalUsers Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\EnumerateLocalUsers' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enumerate-local-users-on-domain-joined-computers-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off app notifications on the lock screen' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off app notifications on the lock screen' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\DisableLockScreenAppNotifications Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\DisableLockScreenAppNotifications' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-app-notifications-on-the-lock-screen-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off picture password sign-in' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off picture password sign-in' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\DisablePicturePassword Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\DisablePicturePassword' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-picture-password-sign-in-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn on convenience PIN sign-in' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn on convenience PIN sign-in' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\Passport\\EnablePinSignIn Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\Passport\\EnablePinSignIn' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-on-convenience-pin-sign-in-is-disabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Configure Offer Remote Assistance' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Configure Offer Remote Assistance' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\RAUnsolicited Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\RAUnsolicited' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:remote, requirement:standard, critical:false, control:configure-offer-remote-assistance-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Configure Solicited Remote Assistance' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Configure Solicited Remote Assistance' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\RAUnsolicitedConsent Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\RAUnsolicitedConsent' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:remote, requirement:standard, critical:false, control:configure-solicited-remote-assistance-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable RPC Endpoint Mapper Client Authentication' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable RPC Endpoint Mapper Client Authentication' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc\\EnableAuthEpResolution Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc\\EnableAuthEpResolution' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:remote, requirement:standard, critical:false, control:enable-rpc-endpoint-mapper-client-authentication-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: "CIS - Ensure 'Restrict Unauthenticated RPC clients' is set to 'Enabled: Authenticated'"
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Restrict Unauthenticated RPC clients' is set to 'Enabled: Authenticated'. Expected state per CIS Intune benchmark: Enabled: Authenticated."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc\\RestrictRemoteClients Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc\\RestrictRemoteClients' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:remote, requirement:standard, critical:false, control:restrict-unauthenticated-rpc-clients-is-enabled-authenticated, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Windows NTP Client' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Windows NTP Client' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\TimeProviders\\NtpClient\\Enabled Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\TimeProviders\\NtpClient\\Enabled' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:time, requirement:standard, critical:false, control:enable-windows-ntp-client-is-enabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Windows NTP Server' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Windows NTP Server' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\TimeProviders\\NtpServer\\Enabled Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\TimeProviders\\NtpServer\\Enabled' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:time, requirement:standard, critical:false, control:enable-windows-ntp-server-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Allow Microsoft accounts to be optional' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Microsoft accounts to be optional' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\EnableMicrosoftAccount Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\EnableMicrosoftAccount' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:time, requirement:standard, critical:false, control:allow-microsoft-accounts-to-be-optional-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Disallow Autoplay for non-volume devices' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Disallow Autoplay for non-volume devices' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\NoAutoplayfornonVolume Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\NoAutoplayfornonVolume' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:disallow-autoplay-for-non-volume-devices-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: "CIS - Ensure 'Turn off Autoplay' is set to 'Enabled: All drives'"
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off Autoplay' is set to 'Enabled: All drives'. Expected state per CIS Intune benchmark: Enabled: All drives."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\NoDriveTypeAutoRun Condition: data = '255'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\NoDriveTypeAutoRun' AND data = '255';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-autoplay-is-enabled-all-drives, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Require additional authentication at startup' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Require additional authentication at startup' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\UseTPM Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\UseTPM' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:require-additional-authentication-at-startup-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Do not display the password reveal button' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Do not display the password reveal button' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredUI\\DisablePasswordReveal Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredUI\\DisablePasswordReveal' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:do-not-display-the-password-reveal-button-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Enumerate administrator accounts on elevation' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enumerate administrator accounts on elevation' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI\\EnumerateAdministrators Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI\\EnumerateAdministrators' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enumerate-administrator-accounts-on-elevation-is-disabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Enable App Installer Experimental Features' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable App Installer Experimental Features' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppInstaller\\EnableExperimentalFeatures Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppInstaller\\EnableExperimentalFeatures' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-app-installer-experimental-features-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Enable App Installer Hash Override' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable App Installer Hash Override' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppInstaller\\EnableHashOverride Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppInstaller\\EnableHashOverride' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-app-installer-hash-override-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Enable App Installer ms-appinstaller protocol' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable App Installer ms-appinstaller protocol' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppInstaller\\EnableMSAppInstallerProtocol Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppInstaller\\EnableMSAppInstallerProtocol' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-app-installer-ms-appinstaller-protocol-is-disabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off Data Execution Prevention for Explorer' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off Data Execution Prevention for Explorer' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\NoDataExecutionPrevention Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\NoDataExecutionPrevention' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-data-execution-prevention-for-explorer-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off heap termination on corruption' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off heap termination on corruption' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\DisableHeapTerminationOnCorruption Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\DisableHeapTerminationOnCorruption' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-heap-termination-on-corruption-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off shell protocol protected mode' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off shell protocol protected mode' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\DisableShellProtocolProtectedMode Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\DisableShellProtocolProtectedMode' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-shell-protocol-protected-mode-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Join Microsoft MAPS' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Join Microsoft MAPS' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\SpynetReporting Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\SpynetReporting' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:join-microsoft-maps-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Configure Watson events' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Configure Watson events' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting\\DisableGenericReports Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting\\DisableGenericReports' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:configure-watson-events-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off Push To Install service' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off Push To Install service' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore\\DisablePushToInstall Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore\\DisablePushToInstall' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-push-to-install-service-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement

- name: CIS - Ensure 'Do not allow passwords to be saved' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Do not allow passwords to be saved' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\DisablePasswordSaving Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\DisablePasswordSaving' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:remote, requirement:standard, critical:false, control:do-not-allow-passwords-to-be-saved-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Do not allow COM port redirection' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Do not allow COM port redirection' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\fDisableCcm Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\fDisableCcm' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:do-not-allow-com-port-redirection-is-enabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Do not allow drive redirection' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Do not allow drive redirection' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\fDisableCdm Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\fDisableCdm' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:do-not-allow-drive-redirection-is-enabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Do not allow LPT port redirection' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Do not allow LPT port redirection' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\fDisableLPT Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\fDisableLPT' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:do-not-allow-lpt-port-redirection-is-enabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Always prompt for password upon connection' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Always prompt for password upon connection' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\fPromptForPassword Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\fPromptForPassword' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:security, requirement:standard, critical:false, control:always-prompt-for-password-upon-connection-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Require secure RPC communication' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Require secure RPC communication' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc\\RequireIntegrityActivationAuthenticationLevel Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc\\RequireIntegrityActivationAuthenticationLevel' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:security, requirement:standard, critical:false, control:require-secure-rpc-communication-is-enabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Do not delete temp folders upon exit' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Do not delete temp folders upon exit' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\AlwaysDeleteTempFiles Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\AlwaysDeleteTempFiles' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:do-not-delete-temp-folders-upon-exit-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Prevent downloading of enclosures' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Prevent downloading of enclosures' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Internet Explorer\\Feeds\\DisableEnclosureDownload Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Internet Explorer\\Feeds\\DisableEnclosureDownload' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:prevent-downloading-of-enclosures-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off the Store application' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off the Store application' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore\\DisableStoreApps Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore\\DisableStoreApps' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-the-store-application-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Enable MPR notifications for the system' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable MPR notifications for the system' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\EnableMPRNotifications Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\EnableMPRNotifications' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-mpr-notifications-for-the-system-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Prevent Codec Download (User)' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Prevent Codec Download (User)' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: User Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'User' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:prevent-codec-download-user-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn on PowerShell Script Block Logging' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn on PowerShell Script Block Logging' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\\EnableScriptBlockLogging Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging\\EnableScriptBlockLogging' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-on-powershell-script-block-logging-is-enabled, cis_safeguard_id:CIS8.2
  purpose: Enforcement
- name: CIS - Ensure 'Turn on PowerShell Transcription' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn on PowerShell Transcription' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription\\EnableTranscription Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription\\EnableTranscription' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-on-powershell-transcription-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Basic authentication' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Basic authentication' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\AllowBasic Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\AllowBasic' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-basic-authentication-is-disabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow unencrypted traffic' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow unencrypted traffic' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\AllowUnencryptedTraffic Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\AllowUnencryptedTraffic' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-unencrypted-traffic-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Disallow Digest authentication' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Disallow Digest authentication' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\AllowDigest Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\AllowDigest' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:disallow-digest-authentication-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow remote server management through WinRM' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow remote server management through WinRM' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\AllowAutoConfig Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\AllowAutoConfig' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-remote-server-management-through-winrm-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Disallow WinRM from storing RunAs credentials' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Disallow WinRM from storing RunAs credentials' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\DisableRunAs Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\DisableRunAs' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:disallow-winrm-from-storing-runas-credentials-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Remote Shell Access' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Remote Shell Access' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\AllowRemoteShellAccess Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\AllowRemoteShellAccess' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:remote, requirement:standard, critical:false, control:allow-remote-shell-access-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Account Logon Audit Credential Validation' is set to 'Success and Failure'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Account Logon Audit Credential Validation' is set to 'Success and Failure'. Expected state per CIS Intune benchmark: Success and Failure."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\CredentialValidation Condition: data = '3'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\CredentialValidation' AND data = '3';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:account-logon-audit-credential-validation-is-success-and-failure, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Account Logon Logoff Audit Logon' is set to 'Success and Failure'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Account Logon Logoff Audit Logon' is set to 'Success and Failure'. Expected state per CIS Intune benchmark: Success and Failure."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\Logon Condition: data = '3'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\Logon' AND data = '3';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:account-logon-logoff-audit-logon-is-success-and-failure, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Audit File Share Access' is set to 'Success and Failure'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Audit File Share Access' is set to 'Success and Failure'. Expected state per CIS Intune benchmark: Success and Failure."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\FileShare Condition: data = '3'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\FileShare' AND data = '3';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:audit-file-share-access-is-success-and-failure, cis_safeguard_id:CIS8.2
  purpose: Enforcement
- name: CIS - Ensure 'Audit Other Logon Logoff Events' is set to 'Success and Failure'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Audit Other Logon Logoff Events' is set to 'Success and Failure'. Expected state per CIS Intune benchmark: Success and Failure."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\OtherLogonLogoffEvents Condition: data = '3'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\OtherLogonLogoffEvents' AND data = '3';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:audit-other-logon-logoff-events-is-success-and-failure, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Audit User Account Management' is set to 'Success and Failure'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Audit User Account Management' is set to 'Success and Failure'. Expected state per CIS Intune benchmark: Success and Failure."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\UserAccountManagement Condition: data = '3'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\UserAccountManagement' AND data = '3';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:audit-user-account-management-is-success-and-failure, cis_safeguard_id:CIS8.2
  purpose: Enforcement
- name: CIS - Ensure 'Object Access Audit Removable Storage' is set to 'Success and Failure'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Object Access Audit Removable Storage' is set to 'Success and Failure'. Expected state per CIS Intune benchmark: Success and Failure."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\RemovableStorage Condition: data = '3'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\RemovableStorage' AND data = '3';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:object-access-audit-removable-storage-is-success-and-failure, cis_safeguard_id:CIS8.2
  purpose: Enforcement
- name: CIS - Ensure 'Privilege Use Audit Sensitive Privilege Use' is set to 'Success and Failure'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Privilege Use Audit Sensitive Privilege Use' is set to 'Success and Failure'. Expected state per CIS Intune benchmark: Success and Failure."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\SensitivePrivilegeUse Condition: data = '3'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\SensitivePrivilegeUse' AND data = '3';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:privilege-use-audit-sensitive-privilege-use-is-success-and-failure, cis_safeguard_id:CIS8.2
  purpose: Enforcement
- name: CIS - Ensure 'System Audit I Psec Driver' is set to 'Success and Failure'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'System Audit I Psec Driver' is set to 'Success and Failure'. Expected state per CIS Intune benchmark: Success and Failure."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\IPsecDriver Condition: data = '3'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\IPsecDriver' AND data = '3';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:system-audit-i-psec-driver-is-success-and-failure, cis_safeguard_id:CIS8.2
  purpose: Enforcement
- name: CIS - Ensure 'System Audit Other System Events' is set to 'Success and Failure'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'System Audit Other System Events' is set to 'Success and Failure'. Expected state per CIS Intune benchmark: Success and Failure."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\OtherSystemEvents Condition: data = '3'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\OtherSystemEvents' AND data = '3';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:system-audit-other-system-events-is-success-and-failure, cis_safeguard_id:CIS8.2
  purpose: Enforcement
- name: CIS - Ensure 'System Audit System Integrity' is set to 'Success and Failure'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'System Audit System Integrity' is set to 'Success and Failure'. Expected state per CIS Intune benchmark: Success and Failure."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\SystemIntegrity Condition: data = '3'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\SystemIntegrity' AND data = '3';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:system-audit-system-integrity-is-success-and-failure, cis_safeguard_id:CIS8.2
  purpose: Enforcement
- name: CIS - Ensure 'Require Device Encryption' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Require Device Encryption' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: ALL Condition: encrypted = 1"
  query: SELECT 1 FROM bitlocker_info WHERE protection_status = 1;
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:encryption, requirement:standard, critical:false, control:require-device-encryption-is-enabled, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Allow Warning For Other Disk Encryption' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Warning For Other Disk Encryption' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\DisableWarningForOtherDiskEncryption Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\DisableWarningForOtherDiskEncryption' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:encryption, requirement:standard, critical:false, control:allow-warning-for-other-disk-encryption-is-disabled, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Allow Camera' is set to 'Not allowed'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Camera' is set to 'Not allowed'. Expected state per CIS Intune benchmark: Not allowed."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Camera\\AllowCamera Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Camera\\AllowCamera' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-camera-is-not-allowed, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Config refresh' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Config refresh' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\ConfigRefreshEnabled Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\ConfigRefreshEnabled' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:config-refresh-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Refresh cadence' is set to '90'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Refresh cadence' is set to '90'. Expected state per CIS Intune benchmark: 90."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\RefreshCadenceDays Condition: data = '90'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\RefreshCadenceDays' AND data = '90';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:refresh-cadence-is-90, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Behavior Monitoring' is set to 'Allowed'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Behavior Monitoring' is set to 'Allowed'. Expected state per CIS Intune benchmark: Allowed."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\\DisableBehaviorMonitoring Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\\DisableBehaviorMonitoring' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-behavior-monitoring-is-allowed, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Email Scanning' is set to 'Allowed'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Email Scanning' is set to 'Allowed'. Expected state per CIS Intune benchmark: Allowed."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Scan\\DisableEmailScanning Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Scan\\DisableEmailScanning' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-email-scanning-is-allowed, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Full Scan Removable Drive Scanning' is set to 'Allowed'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Full Scan Removable Drive Scanning' is set to 'Allowed'. Expected state per CIS Intune benchmark: Allowed."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Scan\\DisableRemovableDriveScanning Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Scan\\DisableRemovableDriveScanning' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-full-scan-removable-drive-scanning-is-allowed, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Realtime Monitoring' is set to 'Allowed'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Realtime Monitoring' is set to 'Allowed'. Expected state per CIS Intune benchmark: Allowed."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\\DisableRealtimeMonitoring Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\\DisableRealtimeMonitoring' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-realtime-monitoring-is-allowed, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Allow scanning of all downloaded files and attachments' is set to 'Allowed'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow scanning of all downloaded files and attachments' is set to 'Allowed'. Expected state per CIS Intune benchmark: Allowed."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\\DisableIOAVProtection Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\\DisableIOAVProtection' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-scanning-of-all-downloaded-files-and-attachments-is-allowed, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Script Scanning' is set to 'Allowed'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Script Scanning' is set to 'Allowed'. Expected state per CIS Intune benchmark: Allowed."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Scan\\DisableScriptScanning Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Scan\\DisableScriptScanning' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-script-scanning-is-allowed, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'ASR: Block Adobe Reader from creating child processes' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'ASR: Block Adobe Reader from creating child processes' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules\\7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules\\7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:asr-block-adobe-reader-from-creating-child-processes-is-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'ASR: Block execution of potentially obfuscated scripts' is set to 'Audit'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'ASR: Block execution of potentially obfuscated scripts' is set to 'Audit'. Expected state per CIS Intune benchmark: Audit."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules\\5beb7efe-fd9a-4556-801d-275e5ffc04cc Condition: data = '2'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules\\5beb7efe-fd9a-4556-801d-275e5ffc04cc' AND data = '2';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:asr-block-execution-of-potentially-obfuscated-scripts-is-audit, cis_safeguard_id:CIS8.2
  purpose: Enforcement
- name: CIS - Ensure 'ASR: Block persistence through WMI event subscription' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'ASR: Block persistence through WMI event subscription' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules\\e6db77e5-3df2-4cf1-b95a-636979351e5b Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules\\e6db77e5-3df2-4cf1-b95a-636979351e5b' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:asr-block-persistence-through-wmi-event-subscription-is-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'ASR: Block Win32 API calls from Office macros' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'ASR: Block Win32 API calls from Office macros' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules\\92e97fa1-2edf-4476-bdd6-9dd0b4dddc7b Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules\\92e97fa1-2edf-4476-bdd6-9dd0b4dddc7b' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:asr-block-win32-api-calls-from-office-macros-is-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'ASR: Use advanced protection against ransomware' is set to 'Audit'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'ASR: Use advanced protection against ransomware' is set to 'Audit'. Expected state per CIS Intune benchmark: Audit."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules\\c1db55ab-c21a-4637-bb3f-a12568109d35 Condition: data = '2'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules\\c1db55ab-c21a-4637-bb3f-a12568109d35' AND data = '2';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:asr-use-advanced-protection-against-ransomware-is-audit, cis_safeguard_id:CIS8.2
  purpose: Enforcement
- name: CIS - Ensure 'Days Until Aggressive Catchup Quick Scan' is set to '7 days'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Days Until Aggressive Catchup Quick Scan' is set to '7 days'. Expected state per CIS Intune benchmark: 7 days."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Scan\\DaysUntilAggressiveCatchupQuickScan Condition: data = '7'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Scan\\DaysUntilAggressiveCatchupQuickScan' AND data = '7';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:days-until-aggressive-catchup-quick-scan-is-7-days, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Enable File Hash Computation' is set to 'Enable'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable File Hash Computation' is set to 'Enable'. Expected state per CIS Intune benchmark: Enable."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\\EnableFileHashComputation Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\\EnableFileHashComputation' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-file-hash-computation-is-enable, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Enable Network Protection' is set to 'Enabled (block mode)'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Network Protection' is set to 'Enabled (block mode)'. Expected state per CIS Intune benchmark: Enabled (block mode)."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: block mode Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'block mode' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-network-protection-is-enabled-block-mode, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Hide Exclusions From Local Users' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Hide Exclusions From Local Users' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\\DisableLocalAdminMerge Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\\DisableLocalAdminMerge' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:hide-exclusions-from-local-users-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Oobe Enable Rtp And Sig Update' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Oobe Enable Rtp And Sig Update' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\\DisableRealtimeMonitoring Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\\DisableRealtimeMonitoring' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:oobe-enable-rtp-and-sig-update-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'PUA Protection' is set to 'PUA Protection on'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'PUA Protection' is set to 'PUA Protection on'. Expected state per CIS Intune benchmark: PUA Protection on."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\PUAProtection Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\PUAProtection' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:pua-protection-is-pua-protection-on, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Quick Scan Include Exclusions' is set to '1'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Quick Scan Include Exclusions' is set to '1'. Expected state per CIS Intune benchmark: 1."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Scan\\QuickScanIncludeExclusions Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Scan\\QuickScanIncludeExclusions' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:quick-scan-include-exclusions-is-1, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Remote Encryption Protection Aggressiveness' is set to 'Medium'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Remote Encryption Protection Aggressiveness' is set to 'Medium'. Expected state per CIS Intune benchmark: Medium."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\RemoteEncryptionProtectionAggressiveness Condition: data = '2'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\RemoteEncryptionProtectionAggressiveness' AND data = '2';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:remote-encryption-protection-aggressiveness-is-medium, cis_safeguard_id:CIS3.4
  purpose: Enforcement
  - name: CIS - Ensure 'Credential Guard' is set to 'Enabled with UEFI lock'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Credential Guard' is set to 'Enabled with UEFI lock'. Expected state per CIS Intune benchmark: Enabled with UEFI lock."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\LsaCfgFlags Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\LsaCfgFlags' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:credential-guard-is-enabled-with-uefi-lock, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Device Password Enabled' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Device Password Enabled' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\DevicePasswordEnabled Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\DevicePasswordEnabled' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:session, requirement:standard, critical:false, control:device-password-enabled-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Minimum Password Age' is set to '1 or more day(s)'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Minimum Password Age' is set to '1 or more day(s)'. Expected state per CIS Intune benchmark: 1 or more day(s)."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\DevicePasswordExpirationDays Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\DevicePasswordExpirationDays' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:session, requirement:standard, critical:false, control:minimum-password-age-is-1-or-more-days, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Device Enumeration Policy' is set to 'Block all (most restrictive)'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Device Enumeration Policy' is set to 'Block all (most restrictive)'. Expected state per CIS Intune benchmark: Block all (most restrictive)."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\DeviceEnumerationPolicy Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\DeviceEnumerationPolicy' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:device-enumeration-policy-is-block-all-most-restrictive, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Cortana' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Cortana' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search\\AllowCortana Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search\\AllowCortana' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-cortana-is-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Spotlight Collection (User)' is set to '0'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Spotlight Collection (User)' is set to '0'. Expected state per CIS Intune benchmark: 0."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent\\DisableSpotlightCollectionOnDesktop Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent\\DisableSpotlightCollectionOnDesktop' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-spotlight-collection-user-is-0, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Windows Spotlight (User)' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Windows Spotlight (User)' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent\\DisableWindowsSpotlightFeatures Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent\\DisableWindowsSpotlightFeatures' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-windows-spotlight-user-is-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Disable Consumer Account State Content' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Disable Consumer Account State Content' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent\\DisableConsumerAccountStateContent Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent\\DisableConsumerAccountStateContent' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:disable-consumer-account-state-content-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Enable Domain Network Firewall' is set to 'True'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Domain Network Firewall' is set to 'True'. Expected state per CIS Intune benchmark: True."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\EnableFirewall Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\EnableFirewall' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-domain-network-firewall-is-true, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Private Network Firewall' is set to 'True'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Private Network Firewall' is set to 'True'. Expected state per CIS Intune benchmark: True."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\EnableFirewall Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\EnableFirewall' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-private-network-firewall-is-true, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Public Network Firewall' is set to 'True'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Public Network Firewall' is set to 'True'. Expected state per CIS Intune benchmark: True."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\EnableFirewall Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\EnableFirewall' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-public-network-firewall-is-true, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Public Network Firewall: Allow Local Policy Merge' is set to 'False'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Public Network Firewall: Allow Local Policy Merge' is set to 'False'. Expected state per CIS Intune benchmark: False."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\EnableFirewall Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\EnableFirewall' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-public-network-firewall-allow-local-policy-merge-is-false, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable insecure guest logons' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable insecure guest logons' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters\\AllowInsecureGuestAuth Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters\\AllowInsecureGuestAuth' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-insecure-guest-logons-is-disabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Disallow KMS Client Online AVS Validation' is set to 'Allow'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Disallow KMS Client Online AVS Validation' is set to 'Allow'. Expected state per CIS Intune benchmark: Allow."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\SoftwareProtectionPlatform\\DisableKMSClientOnlineAVSValidation Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\SoftwareProtectionPlatform\\DisableKMSClientOnlineAVSValidation' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:disallow-kms-client-online-avs-validation-is-allow, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Accounts: Enable Guest account status' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Accounts: Enable Guest account status' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\EnableGuestAccount Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\EnableGuestAccount' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:security, requirement:standard, critical:false, control:accounts-enable-guest-account-status-is-disabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Interactive logon: Do not display last signed-in' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Interactive logon: Do not display last signed-in' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DontDisplayLastUserName Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DontDisplayLastUserName' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:security, requirement:standard, critical:false, control:interactive-logon-do-not-display-last-signed-in-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Interactive logon: Do not require CTRL+ALT+DEL' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Interactive logon: Do not require CTRL+ALT+DEL' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableCAD Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableCAD' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:security, requirement:standard, critical:false, control:interactive-logon-do-not-require-ctrl-alt-del-is-disabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Interactive logon: Smart card removal behavior' is set to 'Lock Workstation'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Interactive logon: Smart card removal behavior' is set to 'Lock Workstation'. Expected state per CIS Intune benchmark: Lock Workstation."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SCRemoveOption Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SCRemoveOption' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:security, requirement:standard, critical:false, control:interactive-logon-smart-card-removal-behavior-is-lock-workstation, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Network Security: Allow PKU2U authentication requests' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Network Security: Allow PKU2U authentication requests' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\pku2u\\AllowOnlineID Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\pku2u\\AllowOnlineID' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:security, requirement:standard, critical:false, control:network-security-allow-pku2u-authentication-requests-is-block, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'User Account Control: Use Admin Approval Mode' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'User Account Control: Use Admin Approval Mode' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableLUA Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableLUA' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:security, requirement:standard, critical:false, control:user-account-control-use-admin-approval-mode-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow apps from the Microsoft app store to auto update' is set to 'Allowed'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow apps from the Microsoft app store to auto update' is set to 'Allowed'. Expected state per CIS Intune benchmark: Allowed."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore\\AutoDownload Condition: data = '2'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore\\AutoDownload' AND data = '2';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-apps-from-the-microsoft-app-store-to-auto-update-is-allowed, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Game DVR' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Game DVR' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\GameDVR\\AllowGameDVR Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\GameDVR\\AllowGameDVR' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-game-dvr-is-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Shared User App Data' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Shared User App Data' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\AllowSharedUserAppData Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\AllowSharedUserAppData' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-shared-user-app-data-is-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Block Non Admin User Install' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Block Non Admin User Install' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\DisableMSI Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\DisableMSI' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:block-non-admin-user-install-is-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Disable Store Originated Apps' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Disable Store Originated Apps' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore\\DisableStoreApps Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore\\DisableStoreApps' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:disable-store-originated-apps-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'MSI Allow user control over installs' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'MSI Allow user control over installs' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\EnableUserControl Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\EnableUserControl' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:msi-allow-user-control-over-installs-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'MSI Always install with elevated privileges' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'MSI Always install with elevated privileges' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\AlwaysInstallElevated' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:msi-always-install-with-elevated-privileges-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'MSI Always install with elevated privileges (User)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'MSI Always install with elevated privileges (User)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: User Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'User' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:msi-always-install-with-elevated-privileges-user-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Disallow Cloud Notification' is set to 'Allow'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Disallow Cloud Notification' is set to 'Allow'. Expected state per CIS Intune benchmark: Allow."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent\\DisableCloudNotifications Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent\\DisableCloudNotifications' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:disallow-cloud-notification-is-allow, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Cross Device Clipboard' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Cross Device Clipboard' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\AllowCrossDeviceClipboard Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\AllowCrossDeviceClipboard' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-cross-device-clipboard-is-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Input Personalization' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Input Personalization' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\InputPersonalization\\AllowInputPersonalization Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\InputPersonalization\\AllowInputPersonalization' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-input-personalization-is-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Disable Advertising ID' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Disable Advertising ID' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AdvertisingInfo\\Disabled Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AdvertisingInfo\\Disabled' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:disable-advertising-id-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Let Apps Activate With Voice Above Lock' is set to 'Enabled: Force Deny'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Let Apps Activate With Voice Above Lock' is set to 'Enabled: Force Deny'. Expected state per CIS Intune benchmark: Enabled: Force Deny."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search\\AllowCortanaAboveLock Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search\\AllowCortanaAboveLock' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:let-apps-activate-with-voice-above-lock-is-enabled-force-deny, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Upload User Activities' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Upload User Activities' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\UploadUserActivities Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\UploadUserActivities' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:upload-user-activities-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Cloud Search' is set to 'Not allowed'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Cloud Search' is set to 'Not allowed'. Expected state per CIS Intune benchmark: Not allowed."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent\\AllowCloudSearch Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent\\AllowCloudSearch' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-cloud-search-is-not-allowed, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Indexing Encrypted Stores Or Items' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Indexing Encrypted Stores Or Items' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search\\AllowIndexingEncryptedStoresOrItems Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search\\AllowIndexingEncryptedStoresOrItems' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-indexing-encrypted-stores-or-items-is-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Search To Use Location' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Search To Use Location' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search\\AllowSearchToUseLocation Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search\\AllowSearchToUseLocation' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-search-to-use-location-is-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow search highlights' is set to '0'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow search highlights' is set to '0'. Expected state per CIS Intune benchmark: 0."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search\\EnableDynamicContentInWSB Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search\\EnableDynamicContentInWSB' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-search-highlights-is-0, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Online Tips' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Online Tips' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent\\AllowOnlineTips Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent\\AllowOnlineTips' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-online-tips-is-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Notify Malicious' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Notify Malicious' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\SmartScreen\\NotifyMalicious Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\SmartScreen\\NotifyMalicious' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:notify-malicious-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Notify Password Reuse' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Notify Password Reuse' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\System\\NotifyPasswordReuse Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\System\\NotifyPasswordReuse' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:notify-password-reuse-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Notify Unsafe App' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Notify Unsafe App' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\SmartScreen\\NotifyUnsafeApp Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\SmartScreen\\NotifyUnsafeApp' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:notify-unsafe-app-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Enable Sudo' is set to 'Sudo is disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Sudo' is set to 'Sudo is disabled'. Expected state per CIS Intune benchmark: Sudo is disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Sudo\\EnableSudo Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Sudo\\EnableSudo' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-sudo-is-sudo-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Font Providers' is set to 'Not allowed'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Font Providers' is set to 'Not allowed'. Expected state per CIS Intune benchmark: Not allowed."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\EnableFontProviders Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\EnableFontProviders' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-font-providers-is-not-allowed, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Location' is set to 'Force Location Off...'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Location' is set to 'Force Location Off...'. Expected state per CIS Intune benchmark: Force Location Off...."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LocationAndSensors\\DisableLocation Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LocationAndSensors\\DisableLocation' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-location-is-force-location-off, cis_safeguard_id:CIS7.3
  purpose: Enforcement
  - name: CIS - Ensure 'Allow Telemetry' is set to 'Basic'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Telemetry' is set to 'Basic'. Expected state per CIS Intune benchmark: Basic."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection\\AllowTelemetry Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection\\AllowTelemetry' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-telemetry-is-basic, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Disable Enterprise Auth Proxy' is set to 'Enable'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Disable Enterprise Auth Proxy' is set to 'Enable'. Expected state per CIS Intune benchmark: Enable."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\DisableEnterpriseAuthProxy Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\DisableEnterpriseAuthProxy' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:disable-enterprise-auth-proxy-is-enable, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Disable One Drive File Sync' is set to 'Sync Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Disable One Drive File Sync' is set to 'Sync Disabled'. Expected state per CIS Intune benchmark: Sync Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\OneDrive\\DisableFileSync Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\OneDrive\\DisableFileSync' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:disable-one-drive-file-sync-is-sync-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Enable OneSettings Auditing' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable OneSettings Auditing' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection\\EnableOneSettingsAuditing Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection\\EnableOneSettingsAuditing' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-onesettings-auditing-is-enabled, cis_safeguard_id:CIS8.2
  purpose: Enforcement
- name: CIS - Ensure 'Limit Diagnostic Log Collection' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Limit Diagnostic Log Collection' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection\\LimitDiagnosticLogCollection Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection\\LimitDiagnosticLogCollection' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:limit-diagnostic-log-collection-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Limit Dump Collection' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Limit Dump Collection' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection\\LimitDumpCollection Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection\\LimitDumpCollection' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:limit-dump-collection-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Bluetooth Audio Gateway Service (BTAGService)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Bluetooth Audio Gateway Service (BTAGService)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: BTAGService Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'BTAGService' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:bluetooth-audio-gateway-service-btagservice-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Bluetooth Support Service (bthserv)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Bluetooth Support Service (bthserv)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: bthserv Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'bthserv' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:bluetooth-support-service-bthserv-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Computer Browser (Browser)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Computer Browser (Browser)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: Browser Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'Browser' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:computer-browser-browser-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Downloaded Maps Manager (MapsBroker)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Downloaded Maps Manager (MapsBroker)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: MapsBroker Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'MapsBroker' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:downloaded-maps-manager-mapsbroker-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'GameInput Service (GameInputSvc)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'GameInput Service (GameInputSvc)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: GameInputSvc Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'GameInputSvc' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:gameinput-service-gameinputsvc-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Geolocation Service (lfsvc)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Geolocation Service (lfsvc)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: lfsvc Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'lfsvc' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:geolocation-service-lfsvc-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'IIS Admin Service (IISADMIN)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'IIS Admin Service (IISADMIN)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: IISADMIN Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'IISADMIN' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:iis-admin-service-iisadmin-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Infrared monitor service (irmon)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Infrared monitor service (irmon)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: irmon Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'irmon' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:infrared-monitor-service-irmon-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Link-Layer Topology Discovery Mapper (lltdsvc)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Link-Layer Topology Discovery Mapper (lltdsvc)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: lltdsvc Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'lltdsvc' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:link-layer-topology-discovery-mapper-lltdsvc-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'LxssManager (LxssManager)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'LxssManager (LxssManager)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: LxssManager Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'LxssManager' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:lxssmanager-lxssmanager-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Microsoft FTP Service (FTPSVC)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Microsoft FTP Service (FTPSVC)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: FTPSVC Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'FTPSVC' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:microsoft-ftp-service-ftpsvc-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Microsoft iSCSI Initiator Service (MSiSCSI)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Microsoft iSCSI Initiator Service (MSiSCSI)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: MSiSCSI Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'MSiSCSI' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:microsoft-iscsi-initiator-service-msiscsi-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'OpenSSH SSH Server (sshd)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'OpenSSH SSH Server (sshd)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: sshd Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'sshd' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:openssh-ssh-server-sshd-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Print Spooler (Spooler)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Print Spooler (Spooler)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: Spooler Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'Spooler' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:print-spooler-spooler-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Remote Access Auto Connection Manager (RasAuto)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Remote Access Auto Connection Manager (RasAuto)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: RasAuto Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'RasAuto' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:remote-access-auto-connection-manager-rasauto-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Remote Desktop Configuration (SessionEnv)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Remote Desktop Configuration (SessionEnv)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: SessionEnv Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'SessionEnv' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:remote-desktop-configuration-sessionenv-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Remote Desktop Services (TermService)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Remote Desktop Services (TermService)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: TermService Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'TermService' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:remote-desktop-services-termservice-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Remote Procedure Call (RPC) Locator (RpcLocator)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Remote Procedure Call (RPC) Locator (RpcLocator)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: RpcLocator Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'RpcLocator' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:remote-procedure-call-rpc-locator-rpclocator-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Remote Registry (RemoteRegistry)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Remote Registry (RemoteRegistry)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: RemoteRegistry Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'RemoteRegistry' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:remote-registry-remoteregistry-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Routing and Remote Access (RemoteAccess)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Routing and Remote Access (RemoteAccess)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: RemoteAccess Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'RemoteAccess' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:routing-and-remote-access-remoteaccess-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Server (LanmanServer)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Server (LanmanServer)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: LanmanServer Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'LanmanServer' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:server-lanmanserver-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Simple TCP/IP Services (simptcp)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Simple TCP/IP Services (simptcp)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: simptcp Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'simptcp' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:simple-tcp-ip-services-simptcp-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'SNMP Service (SNMP)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'SNMP Service (SNMP)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: SNMP Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'SNMP' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:snmp-service-snmp-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Special Administration Console Helper (sacsvr)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Special Administration Console Helper (sacsvr)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: sacsvr Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'sacsvr' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:special-administration-console-helper-sacsvr-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'SSDP Discovery (SSDPSRV)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'SSDP Discovery (SSDPSRV)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: SSDPSRV Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'SSDPSRV' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:ssdp-discovery-ssdpsrv-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'UPnP Device Host (upnphost)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'UPnP Device Host (upnphost)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: upnphost Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'upnphost' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:upnp-device-host-upnphost-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Web Management Service (WMSvc)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Web Management Service (WMSvc)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: WMSvc Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'WMSvc' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:web-management-service-wmsvc-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Windows Error Reporting Service (WerSvc)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Windows Error Reporting Service (WerSvc)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: WerSvc Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'WerSvc' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:windows-error-reporting-service-wersvc-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Windows Event Collector (Wecsvc)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Windows Event Collector (Wecsvc)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: Wecsvc Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'Wecsvc' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:windows-event-collector-wecsvc-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Windows Mobile Hotspot Service (icssvc)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Windows Mobile Hotspot Service (icssvc)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: icssvc Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'icssvc' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:windows-mobile-hotspot-service-icssvc-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Windows PushToInstall Service (PushToInstall)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Windows PushToInstall Service (PushToInstall)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: PushToInstall Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'PushToInstall' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:windows-pushtoinstall-service-pushtoinstall-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'World Wide Web Publishing Service (W3SVC)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'World Wide Web Publishing Service (W3SVC)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: W3SVC Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'W3SVC' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:world-wide-web-publishing-service-w3svc-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Xbox Accessory Management Service (XboxGipSvc)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Xbox Accessory Management Service (XboxGipSvc)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: XboxGipSvc Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'XboxGipSvc' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:xbox-accessory-management-service-xboxgipsvc-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Xbox Live Auth Manager (XblAuthManager)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Xbox Live Auth Manager (XblAuthManager)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: XblAuthManager Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'XblAuthManager' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:xbox-live-auth-manager-xblauthmanager-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Xbox Live Game Save (XblGameSave)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Xbox Live Game Save (XblGameSave)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: XblGameSave Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'XblGameSave' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:xbox-live-game-save-xblgamesave-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Xbox Live Networking Service (XboxNetApiSvc)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Xbox Live Networking Service (XboxNetApiSvc)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: XboxNetApiSvc Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'XboxNetApiSvc' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:xbox-live-networking-service-xboxnetapisvc-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Hypervisor Enforced Code Integrity' is set to 'Enabled with UEFI lock'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Hypervisor Enforced Code Integrity' is set to 'Enabled with UEFI lock'. Expected state per CIS Intune benchmark: Enabled with UEFI lock."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\DeviceGuard\\HypervisorEnforcedCodeIntegrity Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\DeviceGuard\\HypervisorEnforcedCodeIntegrity' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:hypervisor-enforced-code-integrity-is-enabled-with-uefi-lock, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Auto Connect To Wi Fi Sense Hotspots' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Auto Connect To Wi Fi Sense Hotspots' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\Connectivity\\WiFiSenseAutoConnect Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\Connectivity\\WiFiSenseAutoConnect' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-auto-connect-to-wi-fi-sense-hotspots-is-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow widgets' is set to 'Not allowed'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow widgets' is set to 'Not allowed'. Expected state per CIS Intune benchmark: Not allowed."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Widgets\\AllowWidgets Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Widgets\\AllowWidgets' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-widgets-is-not-allowed, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Disallow Exploit Protection Override' is set to '(Enable)'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Disallow Exploit Protection Override' is set to '(Enable)'. Expected state per CIS Intune benchmark: (Enable)."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\ExploitGuard\\DisallowExploitProtectionOverride Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\ExploitGuard\\DisallowExploitProtectionOverride' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:security, requirement:standard, critical:false, control:disallow-exploit-protection-override-is-enable, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Facial Features Use Enhanced Anti Spoofing' is set to 'true'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Facial Features Use Enhanced Anti Spoofing' is set to 'true'. Expected state per CIS Intune benchmark: true."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\EnableAntiSpoofing Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\EnableAntiSpoofing' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:facial-features-use-enhanced-anti-spoofing-is-true, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Minimum PIN Length' is set to '6 more character(s)'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Minimum PIN Length' is set to '6 more character(s)'. Expected state per CIS Intune benchmark: 6 more character(s)."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\Passport\\MinPinLength Condition: data = '6'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\Passport\\MinPinLength' AND data = '6';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:minimum-pin-length-is-6-more-characters, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Require Security Device' is set to 'true'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Require Security Device' is set to 'true'. Expected state per CIS Intune benchmark: true."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\RequireSecurityDevice Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\RequireSecurityDevice' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:require-security-device-is-true, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow suggested apps in Windows Ink Workspace' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow suggested apps in Windows Ink Workspace' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsInkWorkspace\\AllowSuggestedApps Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsInkWorkspace\\AllowSuggestedApps' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-suggested-apps-in-windows-ink-workspace-is-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Windows Ink Workspace' is set to 'Enabled: but the user can'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Windows Ink Workspace' is set to 'Enabled: but the user can'. Expected state per CIS Intune benchmark: Enabled: but the user can."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsInkWorkspace\\AllowWindowsInkWorkspace Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsInkWorkspace\\AllowWindowsInkWorkspace' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-windows-ink-workspace-is-enabled-but-the-user-can, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Clipboard Redirection' is set to 'Not allowed'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Clipboard Redirection' is set to 'Not allowed'. Expected state per CIS Intune benchmark: Not allowed."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\fDisableClip Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\fDisableClip' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-clipboard-redirection-is-not-allowed, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Allow Networking' is set to 'Not allowed'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Networking' is set to 'Not allowed'. Expected state per CIS Intune benchmark: Not allowed."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\Connectivity\\AllowNetworking Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\Connectivity\\AllowNetworking' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-networking-is-not-allowed, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Allow Auto Update' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Auto Update' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\Update\\AllowAutoUpdate Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\Update\\AllowAutoUpdate' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-auto-update-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Defer Quality Updates Period (Days)' is set to 'Enabled: 0 days'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Defer Quality Updates Period (Days)' is set to 'Enabled: 0 days'. Expected state per CIS Intune benchmark: Enabled: 0 days."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: Days Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'Days' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:defer-quality-updates-period-days-is-enabled-0-days, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Manage preview builds' is set to 'Disable Preview builds'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Manage preview builds' is set to 'Disable Preview builds'. Expected state per CIS Intune benchmark: Disable Preview builds."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\ManagePreviewBuilds Condition: data = '2'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\ManagePreviewBuilds' AND data = '2';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:manage-preview-builds-is-disable-preview-builds, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Scheduled Install Day' is set to 'Every day'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Scheduled Install Day' is set to 'Every day'. Expected state per CIS Intune benchmark: Every day."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\\ScheduledInstallDay Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\\ScheduledInstallDay' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:scheduled-install-day-is-every-day, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Block "Pause Updates" ability' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Block \"Pause Updates\" ability' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\SetDisablePauseUXAccess Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\SetDisablePauseUXAccess' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:block-pause-updates-ability-is-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Backup Directory' is set to 'Backup the password to Azure AD only'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Backup Directory' is set to 'Backup the password to Azure AD only'. Expected state per CIS Intune benchmark: Backup the password to Azure AD only."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\BackupDirectory Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\BackupDirectory' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:backup-directory-is-backup-the-password-to-azure-ad-only, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Password Age Days' is set to 'Configured: 30 or fewer'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Password Age Days' is set to 'Configured: 30 or fewer'. Expected state per CIS Intune benchmark: Configured: 30 or fewer."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\DevicePasswordExpirationDays Condition: data = '30'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\DevicePasswordExpirationDays' AND data = '30';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:password-age-days-is-configured-30-or-fewer, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Password Length' is set to 'Configured: 15 or more'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Password Length' is set to 'Configured: 15 or more'. Expected state per CIS Intune benchmark: Configured: 15 or more."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\MinDevicePasswordLength Condition: data = '15'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\MinDevicePasswordLength' AND data = '15';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:password-length-is-configured-15-or-more, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Apply UAC restrictions to local accounts on network logons' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Apply UAC restrictions to local accounts on network logons' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:security, requirement:standard, critical:false, control:apply-uac-restrictions-to-local-accounts-on-network-logons-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Configure SMB v1 client driver' is set to 'Enabled: Disable driver (recommended)'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Configure SMB v1 client driver' is set to 'Enabled: Disable driver (recommended)'. Expected state per CIS Intune benchmark: Enabled: Disable driver (recommended)."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: recommended Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'recommended' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:configure-smb-v1-client-driver-is-enabled-disable-driver-recommended, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Structured Exception Handling Overwrite Protection (SEHOP)' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Structured Exception Handling Overwrite Protection (SEHOP)' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: SEHOP Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'SEHOP' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-structured-exception-handling-overwrite-protection-sehop-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
  - name: CIS - Ensure 'MSS: (AutoAdminLogon) Enable Automatic Logon (not recommended)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'MSS: (AutoAdminLogon) Enable Automatic Logon (not recommended)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: not recommended Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'not recommended' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:mss-autoadminlogon-enable-automatic-logon-not-recommended-is-disabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'MSS: (DisableIPSourceRouting IPv6) IP source routing protection level (protects against packet spoofing)' is set to 'Enabled: Highest protection, source routing is completely disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'MSS: (DisableIPSourceRouting IPv6) IP source routing protection level (protects against packet spoofing)' is set to 'Enabled: Highest protection, source routing is completely disabled'. Expected state per CIS Intune benchmark: Enabled: Highest protection, source routing is completely disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: protects against packet spoofing Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'protects against packet spoofing' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:mss-disableipsourcerouting-ipv6-ip-source-routing-protection-level-protects-against-packet-spoofing-is-enabled-highest-p, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'MSS: (DisableIPSourceRouting) IP source routing protection level (protects against packet spoofing)' is set to 'Enabled: Highest protection, source routing is completely disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'MSS: (DisableIPSourceRouting) IP source routing protection level (protects against packet spoofing)' is set to 'Enabled: Highest protection, source routing is completely disabled'. Expected state per CIS Intune benchmark: Enabled: Highest protection, source routing is completely disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: protects against packet spoofing Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'protects against packet spoofing' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:mss-disableipsourcerouting-ip-source-routing-protection-level-protects-against-packet-spoofing-is-enabled-highest-protec, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'MSS: (DisableSavePassword) Prevent the dial-up password from being saved (recommended)' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'MSS: (DisableSavePassword) Prevent the dial-up password from being saved (recommended)' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: recommended Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'recommended' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:mss-disablesavepassword-prevent-the-dial-up-password-from-being-saved-recommended-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'MSS: (EnableICMPRedirect) Allow ICMP redirects to override OSPF generated routes' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'MSS: (EnableICMPRedirect) Allow ICMP redirects to override OSPF generated routes' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: EnableICMPRedirect Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'EnableICMPRedirect' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:mss-enableicmpredirect-allow-icmp-redirects-to-override-ospf-generated-routes-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'MSS: (KeepAliveTime) How often keep-alive packets are sent in milliseconds' is set to 'Enabled: 300,000 or 5 minutes (recommended)'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'MSS: (KeepAliveTime) How often keep-alive packets are sent in milliseconds' is set to 'Enabled: 300,000 or 5 minutes (recommended)'. Expected state per CIS Intune benchmark: Enabled: 300,000 or 5 minutes (recommended)."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: recommended Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'recommended' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:mss-keepalivetime-how-often-keep-alive-packets-are-sent-in-milliseconds-is-enabled-300000-or-5-minutes-recommended, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'MSS: (NoNameReleaseOnDemand) Allow the computer to ignore NetBIOS name release requests except from WINS servers' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'MSS: (NoNameReleaseOnDemand) Allow the computer to ignore NetBIOS name release requests except from WINS servers' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: NoNameReleaseOnDemand Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'NoNameReleaseOnDemand' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:mss-nonamereleaseondemand-allow-the-computer-to-ignore-netbios-name-release-requests-except-from-wins-servers-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'MSS: (PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'MSS: (PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: could lead to DoS Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'could lead to DoS' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:mss-performrouterdiscovery-allow-irdp-to-detect-and-configure-default-gateway-addresses-could-lead-to-dos-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'MSS: (SafeDllSearchMode) Enable Safe DLL search mode (recommended)' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'MSS: (SafeDllSearchMode) Enable Safe DLL search mode (recommended)' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: recommended Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'recommended' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:mss-safedllsearchmode-enable-safe-dll-search-mode-recommended-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'MSS: (ScreenSaverGracePeriod) The time in seconds before the screen saver grace period expires (0 recommended)' is set to 'Enabled: 5 or fewer seconds'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'MSS: (ScreenSaverGracePeriod) The time in seconds before the screen saver grace period expires (0 recommended)' is set to 'Enabled: 5 or fewer seconds'. Expected state per CIS Intune benchmark: Enabled: 5 or fewer seconds."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: 0 recommended Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = '0 recommended' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:mss-screensavergraceperiod-the-time-in-seconds-before-the-screen-saver-grace-period-expires-0-recommended-is-enabled-5-o, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'MSS: (TcpMaxDataRetransmissions IPv6) How many times unacknowledged data is retransmitted' is set to 'Enabled: 3'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'MSS: (TcpMaxDataRetransmissions IPv6) How many times unacknowledged data is retransmitted' is set to 'Enabled: 3'. Expected state per CIS Intune benchmark: Enabled: 3."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: TcpMaxDataRetransmissions IPv6 Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'TcpMaxDataRetransmissions IPv6' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:session, requirement:standard, critical:false, control:mss-tcpmaxdataretransmissions-ipv6-how-many-times-unacknowledged-data-is-retransmitted-is-enabled-3, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'MSS: (TcpMaxDataRetransmissions) How many times unacknowledged data is retransmitted' is set to 'Enabled: 3'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'MSS: (TcpMaxDataRetransmissions) How many times unacknowledged data is retransmitted' is set to 'Enabled: 3'. Expected state per CIS Intune benchmark: Enabled: 3."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: TcpMaxDataRetransmissions Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'TcpMaxDataRetransmissions' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:security, requirement:standard, critical:false, control:mss-tcpmaxdataretransmissions-how-many-times-unacknowledged-data-is-retransmitted-is-enabled-3, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'MSS: (WarningLevel) Percentage threshold for the security event log at which the system will generate a warning' is set to 'Enabled: 90% or less'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'MSS: (WarningLevel) Percentage threshold for the security event log at which the system will generate a warning' is set to 'Enabled: 90% or less'. Expected state per CIS Intune benchmark: Enabled: 90% or less."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: WarningLevel Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'WarningLevel' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:security, requirement:standard, critical:false, control:mss-warninglevel-percentage-threshold-for-the-security-event-log-at-which-the-system-will-generate-a-warning-is-enabled-, cis_safeguard_id:CIS8.2
  purpose: Enforcement
- name: CIS - Ensure 'Prohibit installation and configuration of Network Bridge on your DNS domain network' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Prohibit installation and configuration of Network Bridge on your DNS domain network' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections\\NC_AllowNetBridge_NLA Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections\\NC_AllowNetBridge_NLA' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:network, requirement:standard, critical:false, control:prohibit-installation-and-configuration-of-network-bridge-on-your-dns-domain-network-is-enabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Prohibit use of Internet Connection Sharing on your DNS domain network' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Prohibit use of Internet Connection Sharing on your DNS domain network' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections\\NC_AllowICS Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections\\NC_AllowICS' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:prohibit-use-of-internet-connection-sharing-on-your-dns-domain-network-is-enabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Hardened UNC Paths' is set to 'Enabled, with "Require Mutual Authentication", "Require Integrity", and Require Privacy set for all NETLOGON and SYSVOL shares'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Hardened UNC Paths' is set to 'Enabled, with \"Require Mutual Authentication\", \"Require Integrity\", and Require Privacy set for all NETLOGON and SYSVOL shares'. Expected state per CIS Intune benchmark: Enabled, with \"Require Mutual Authentication\", \"Require Integrity\", and Require Privacy set for all NETLOGON and SYSVOL shares."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\NetworkProvider\\HardenedPaths\\RequirePrivacy Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\NetworkProvider\\HardenedPaths\\RequirePrivacy' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:network, requirement:standard, critical:false, control:hardened-unc-paths-is-enabled-with-require-mutual-authentication-require-integrity, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Configuration of wireless settings using Windows Connect Now' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Configuration of wireless settings using Windows Connect Now' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\EnableRegistrars Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\EnableRegistrars' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:configuration-of-wireless-settings-using-windows-connect-now-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Minimize the number of simultaneous connections to the Internet or a Windows Domain' is set to 'Enabled: 3 = Prevent Wi-Fi when on Ethernet'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Minimize the number of simultaneous connections to the Internet or a Windows Domain' is set to 'Enabled: 3 = Prevent Wi-Fi when on Ethernet'. Expected state per CIS Intune benchmark: Enabled: 3 = Prevent Wi-Fi when on Ethernet."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WcmSvc\\GroupPolicy\\fMinimizeConnections Condition: data = '3'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WcmSvc\\GroupPolicy\\fMinimizeConnections' AND data = '3';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:minimize-the-number-of-simultaneous-connections-to-the-internet-or-a-windows-domain-is-enabled-3-prevent-wi-fi-when-on-e, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Prohibit connection to non-domain networks when connected to domain authenticated network' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Prohibit connection to non-domain networks when connected to domain authenticated network' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections\\NC_ProhibitNonDomainConnections Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections\\NC_ProhibitNonDomainConnections' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:network, requirement:standard, critical:false, control:prohibit-connection-to-non-domain-networks-when-connected-to-domain-authenticated-network-is-enabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Configure Redirection Guard: Redirection Guard Options' is set to 'Enabled: Redirection Guard Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Configure Redirection Guard: Redirection Guard Options' is set to 'Enabled: Redirection Guard Enabled'. Expected state per CIS Intune benchmark: Enabled: Redirection Guard Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\RedirectionGuardEnabled Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\RedirectionGuardEnabled' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:configure-redirection-guard-redirection-guard-options-is-enabled-redirection-guard-enabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Configure RPC connection settings: Protocol to use for outgoing RPC connections' is set to 'Enabled: RPC over TCP'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Configure RPC connection settings: Protocol to use for outgoing RPC connections' is set to 'Enabled: RPC over TCP'. Expected state per CIS Intune benchmark: Enabled: RPC over TCP."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc\\ProtocolOrder Condition: data = 'ncacn_ip_tcp'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc\\ProtocolOrder' AND data = 'ncacn_ip_tcp';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:configure-rpc-connection-settings-protocol-to-use-for-outgoing-rpc-connections-is-enabled-rpc-over-tcp, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Configure RPC connection settings: Use authentication for outgoing RPC connections' is set to 'Enabled: Default'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Configure RPC connection settings: Use authentication for outgoing RPC connections' is set to 'Enabled: Default'. Expected state per CIS Intune benchmark: Enabled: Default."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc\\EnableAuthEpResolution Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc\\EnableAuthEpResolution' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:configure-rpc-connection-settings-use-authentication-for-outgoing-rpc-connections-is-enabled-default, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Configure RPC listener settings: Authentication protocol to use for incoming RPC connections:' is set to 'Enabled: Negotiate'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Configure RPC listener settings: Authentication protocol to use for incoming RPC connections:' is set to 'Enabled: Negotiate'. Expected state per CIS Intune benchmark: Enabled: Negotiate."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc\\AuthProtocol Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc\\AuthProtocol' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:configure-rpc-listener-settings-authentication-protocol-to-use-for-incoming-rpc-connections-is-enabled-negotiate, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Configure RPC listener settings: Protocols to allow for incoming RPC connections' is set to 'Enabled: RPC over TCP'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Configure RPC listener settings: Protocols to allow for incoming RPC connections' is set to 'Enabled: RPC over TCP'. Expected state per CIS Intune benchmark: Enabled: RPC over TCP."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc\\ProtocolOrder Condition: data = 'ncacn_ip_tcp'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc\\ProtocolOrder' AND data = 'ncacn_ip_tcp';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:configure-rpc-listener-settings-protocols-to-allow-for-incoming-rpc-connections-is-enabled-rpc-over-tcp, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Manage processing of Queue-specific files: Manage processing of Queue-Specific files' is set to 'Enabled: Limit Queue-specific files to Color profiles'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Manage processing of Queue-specific files: Manage processing of Queue-Specific files' is set to 'Enabled: Limit Queue-specific files to Color profiles'. Expected state per CIS Intune benchmark: Enabled: Limit Queue-specific files to Color profiles."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\ManageProcessingOfQueueSpecificFiles Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\ManageProcessingOfQueueSpecificFiles' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:manage-processing-of-queue-specific-files-manage-processing-of-queue-specific-files-is-enabled-limit-queue-specific-file, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Point and Print Restrictions: When installing drivers for a new connection' is set to 'Enabled: Show warning and elevation prompt'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Point and Print Restrictions: When installing drivers for a new connection' is set to 'Enabled: Show warning and elevation prompt'. Expected state per CIS Intune benchmark: Enabled: Show warning and elevation prompt."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: COMPOUND Condition: SELECT 1 WHERE EXISTS (SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\PointAndPrint\\NoWarningNoElevationOnInstall' AND data = '0') AND EXISTS (SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\PointAndPrint\\UpdatePromptSettings' AND data = '2');"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers\PointAndPrint\NoWarningNoElevationOnInstall' AND data = '0') AND EXISTS (SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers\PointAndPrint\UpdatePromptSettings' AND data = '2');
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:point-and-print-restrictions-when-installing-drivers-for-a-new-connection-is-enabled-show-warning-and-elevation-prompt, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Point and Print Restrictions: When updating drivers for an existing connection' is set to 'Enabled: Show warning and elevation prompt'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Point and Print Restrictions: When updating drivers for an existing connection' is set to 'Enabled: Show warning and elevation prompt'. Expected state per CIS Intune benchmark: Enabled: Show warning and elevation prompt."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: COMPOUND Condition: SELECT 1 WHERE EXISTS (SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\PointAndPrint\\NoWarningNoElevationOnInstall' AND data = '0') AND EXISTS (SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\PointAndPrint\\UpdatePromptSettings' AND data = '2');"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers\PointAndPrint\NoWarningNoElevationOnInstall' AND data = '0') AND EXISTS (SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers\PointAndPrint\UpdatePromptSettings' AND data = '2');
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:point-and-print-restrictions-when-updating-drivers-for-an-existing-connection-is-enabled-show-warning-and-elevation-prom, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Encryption Oracle Remediation' is set to 'Enabled: Force Updated Clients'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Encryption Oracle Remediation' is set to 'Enabled: Force Updated Clients'. Expected state per CIS Intune benchmark: Enabled: Force Updated Clients."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredSSP\\Parameters\\AllowEncryptionOracle Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredSSP\\Parameters\\AllowEncryptionOracle' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:encryption-oracle-remediation-is-enabled-force-updated-clients, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Remote host allows delegation of non-exportable credentials' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Remote host allows delegation of non-exportable credentials' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredentialsDelegation\\AllowProtectedCreds Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredentialsDelegation\\AllowProtectedCreds' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:remote-host-allows-delegation-of-non-exportable-credentials-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Prevent installation of devices using drivers that match these device setup classes' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Prevent installation of devices using drivers that match these device setup classes' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceInstall\\Restrictions\\DenyDeviceClasses Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceInstall\\Restrictions\\DenyDeviceClasses' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:prevent-installation-of-devices-using-drivers-that-match-these-device-setup-classes-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Prevent installation of devices using drivers that match these device setup classes: Also apply to matching devices that are already installed.' is set to 'True'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Prevent installation of devices using drivers that match these device setup classes: Also apply to matching devices that are already installed.' is set to 'True'. Expected state per CIS Intune benchmark: True."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceInstall\\Restrictions\\DenyDeviceClassesRetroactive Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceInstall\\Restrictions\\DenyDeviceClassesRetroactive' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:prevent-installation-of-devices-using-drivers-that-match-these-device-setup-classes-also-apply-to-matching-devices-that-, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Prevent installation of devices using drivers that match these device setup classes: Prevent installation of devices using drivers for these device setup' is set to 'IEEE 1394 device setup classes'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Prevent installation of devices using drivers that match these device setup classes: Prevent installation of devices using drivers for these device setup' is set to 'IEEE 1394 device setup classes'. Expected state per CIS Intune benchmark: IEEE 1394 device setup classes."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceInstall\\Restrictions\\DenyDeviceClassesList Condition: data LIKE '%1394%'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceInstall\\Restrictions\\DenyDeviceClassesList' AND data LIKE '%1394%';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:prevent-installation-of-devices-using-drivers-that-match-these-device-setup-classes-prevent-installation-of-devices-usin, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Boot-Start Driver Initialization Policy' is set to 'Enabled: Good, unknown and bad but critical'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Boot-Start Driver Initialization Policy' is set to 'Enabled: Good, unknown and bad but critical'. Expected state per CIS Intune benchmark: Enabled: Good, unknown and bad but critical."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Configuration Manager\\BootDriverInitPolicy Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Configuration Manager\\BootDriverInitPolicy' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:boot-start-driver-initialization-policy-is-enabled-good-unknown-and-bad-but-critical, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off Help Experience Improvement Program (User)' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off Help Experience Improvement Program (User)' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: User Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'User' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-help-experience-improvement-program-user-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Internet Explorer\\Main\\DisableFirstRunCustomize Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Internet Explorer\\Main\\DisableFirstRunCustomize' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-internet-connection-wizard-if-url-connection-is-referring-to-microsoft-com-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off Internet download for Web publishing and online ordering wizards' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off Internet download for Web publishing and online ordering wizards' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Internet Explorer\\Main\\DisableWebPublishingWizard Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Internet Explorer\\Main\\DisableWebPublishingWizard' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-internet-download-for-web-publishing-and-online-ordering-wizards-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off Registration if URL connection is referring to Microsoft.com' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off Registration if URL connection is referring to Microsoft.com' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Internet Explorer\\Main\\DisableRegistrationWizard Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Internet Explorer\\Main\\DisableRegistrationWizard' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:network, requirement:standard, critical:false, control:turn-off-registration-if-url-connection-is-referring-to-microsoft-com-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off the "Publish to Web" task for files and folders' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off the \"Publish to Web\" task for files and folders' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\NoPublishingWizard Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\NoPublishingWizard' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-the-publish-to-web-task-for-files-and-folders-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off the Windows Messenger Customer Experience Improvement Program' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off the Windows Messenger Customer Experience Improvement Program' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client\\CEIP Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client\\CEIP' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-the-windows-messenger-customer-experience-improvement-program-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Turn off Windows Customer Experience Improvement Program' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off Windows Customer Experience Improvement Program' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows\\CEIPEnable Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows\\CEIPEnable' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-windows-customer-experience-improvement-program-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
  - name: CIS - Ensure 'Support device authentication using certificate' is set to 'Enabled: Automatic'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Support device authentication using certificate' is set to 'Enabled: Automatic'. Expected state per CIS Intune benchmark: Enabled: Automatic."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\DeviceAuthUsingCert Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\DeviceAuthUsingCert' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:support-device-authentication-using-certificate-is-enabled-automatic, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Disallow copying of user input methods to the system account for sign-in' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Disallow copying of user input methods to the system account for sign-in' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\ControlPanel\\International\\BlockUserLocaleChange Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\ControlPanel\\International\\BlockUserLocaleChange' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:disallow-copying-of-user-input-methods-to-the-system-account-for-sign-in-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Do not enumerate connected users on domain-joined computers' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Do not enumerate connected users on domain-joined computers' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\DontEnumerateConnectedUsers Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\DontEnumerateConnectedUsers' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:do-not-enumerate-connected-users-on-domain-joined-computers-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Require a password when a computer wakes (on battery)' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Require a password when a computer wakes (on battery)' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: on battery Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'on battery' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:require-a-password-when-a-computer-wakes-on-battery-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Require a password when a computer wakes (plugged in)' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Require a password when a computer wakes (plugged in)' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: plugged in Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'plugged in' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:session, requirement:standard, critical:false, control:require-a-password-when-a-computer-wakes-plugged-in-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Microsoft Support Diagnostic Tool: Turn on MSDT interactive communication with support provider' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Microsoft Support Diagnostic Tool: Turn on MSDT interactive communication with support provider' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\ScriptedDiagnostics\\EnableQueryRemoteServer Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\ScriptedDiagnostics\\EnableQueryRemoteServer' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:microsoft-support-diagnostic-tool-turn-on-msdt-interactive-communication-with-support-provider-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Block launching Universal Windows apps with Windows Runtime API access from hosted content.' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Block launching Universal Windows apps with Windows Runtime API access from hosted content.' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Embedded\\AllowEdgeHostedAppRuntimeAccess Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Embedded\\AllowEdgeHostedAppRuntimeAccess' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:accounts, requirement:standard, critical:false, control:block-launching-universal-windows-apps-with-windows-runtime-api-access-from-hosted-content-is-enabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Do not preserve zone information in file attachments (User)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Do not preserve zone information in file attachments (User)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: User Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'User' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:do-not-preserve-zone-information-in-file-attachments-user-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Notify antivirus programs when opening attachments (User)' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Notify antivirus programs when opening attachments (User)' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: User Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'User' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:notify-antivirus-programs-when-opening-attachments-user-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Set the default behavior for AutoRun' is set to 'Enabled: Do not execute any autorun commands'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Set the default behavior for AutoRun' is set to 'Enabled: Do not execute any autorun commands'. Expected state per CIS Intune benchmark: Enabled: Do not execute any autorun commands."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoAutorun Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoAutorun' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:set-the-default-behavior-for-autorun-is-enabled-do-not-execute-any-autorun-commands, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Choose how BitLocker-protected fixed drives can be recovered' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Choose how BitLocker-protected fixed drives can be recovered' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\FDVManageRecovery Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\FVE\FDVManageRecovery' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:choose-how-bitlocker-protected-fixed-drives-can-be-recovered-is-enabled, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Choose how BitLocker-protected fixed drives can be recovered: Recovery Key' is set to 'Enabled: Allow 256-bit recovery key'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Choose how BitLocker-protected fixed drives can be recovered: Recovery Key' is set to 'Enabled: Allow 256-bit recovery key'. Expected state per CIS Intune benchmark: Enabled: Allow 256-bit recovery key."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\FDVRecoveryKey Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\FVE\FDVRecoveryKey' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:choose-how-bitlocker-protected-fixed-drives-can-be-recovered-recovery-key-is-enabled-allow-256-bit-recovery-key, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Choose how BitLocker-protected fixed drives can be recovered: Recovery Password' is set to 'Enabled: Allow 48-digit recovery password'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Choose how BitLocker-protected fixed drives can be recovered: Recovery Password' is set to 'Enabled: Allow 48-digit recovery password'. Expected state per CIS Intune benchmark: Enabled: Allow 48-digit recovery password."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\FDVRecoveryPassword Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\FVE\FDVRecoveryPassword' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:choose-how-bitlocker-protected-fixed-drives-can-be-recovered-recovery-password-is-enabled-allow-48-digit-recovery-passwo, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Choose how BitLocker-protected fixed drives can be recovered: Allow data recovery agent' is set to 'Enabled: True'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Choose how BitLocker-protected fixed drives can be recovered: Allow data recovery agent' is set to 'Enabled: True'. Expected state per CIS Intune benchmark: Enabled: True."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\FDVDataRecoveryAgent Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\FVE\FDVDataRecoveryAgent' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:choose-how-bitlocker-protected-fixed-drives-can-be-recovered-allow-data-recovery-agent-is-enabled-true, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Choose how BitLocker-protected fixed drives can be recovered: Configure storage of BitLocker recovery information to AD DS' is set to 'Enabled: Backup recovery passwords and key packages'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Choose how BitLocker-protected fixed drives can be recovered: Configure storage of BitLocker recovery information to AD DS' is set to 'Enabled: Backup recovery passwords and key packages'. Expected state per CIS Intune benchmark: Enabled: Backup recovery passwords and key packages."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\FDVActiveDirectoryBackup Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\FVE\FDVActiveDirectoryBackup' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:choose-how-bitlocker-protected-fixed-drives-can-be-recovered-configure-storage-of-bitlocker-recovery-information-to-ad-d, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Choose how BitLocker-protected fixed drives can be recovered: Do not enable BitLocker until recovery information is stored to AD DS for fixed data drives' is set to 'Enabled: False'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Choose how BitLocker-protected fixed drives can be recovered: Do not enable BitLocker until recovery information is stored to AD DS for fixed data drives' is set to 'Enabled: False'. Expected state per CIS Intune benchmark: Enabled: False."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\FDVRequireActiveDirectoryBackup Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\FVE\FDVRequireActiveDirectoryBackup' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:choose-how-bitlocker-protected-fixed-drives-can-be-recovered-do-not-enable-bitlocker-until-recovery-information-is-store, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Choose how BitLocker-protected fixed drives can be recovered: Omit recovery options from the BitLocker setup wizard' is set to 'Enabled: True'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Choose how BitLocker-protected fixed drives can be recovered: Omit recovery options from the BitLocker setup wizard' is set to 'Enabled: True'. Expected state per CIS Intune benchmark: Enabled: True."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\FDVHideRecoveryPage Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\FVE\FDVHideRecoveryPage' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:choose-how-bitlocker-protected-fixed-drives-can-be-recovered-omit-recovery-options-from-the-bitlocker-setup-wizard-is-en, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Choose how BitLocker-protected fixed drives can be recovered: Save BitLocker recovery information to AD DS for fixed data drives' is set to 'Enabled: False'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Choose how BitLocker-protected fixed drives can be recovered: Save BitLocker recovery information to AD DS for fixed data drives' is set to 'Enabled: False'. Expected state per CIS Intune benchmark: Enabled: False."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\FDVActiveDirectoryBackup Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\FVE\FDVActiveDirectoryBackup' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:choose-how-bitlocker-protected-fixed-drives-can-be-recovered-save-bitlocker-recovery-information-to-ad-ds-for-fixed-data, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Choose how BitLocker-protected operating system drives can be recovered' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Choose how BitLocker-protected operating system drives can be recovered' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\OSManageRecovery Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\OSManageRecovery' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:choose-how-bitlocker-protected-operating-system-drives-can-be-recovered-is-enabled, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Choose how BitLocker-protected operating system drives can be recovered: Recovery Key' is set to 'Enabled: Do not allow 256-bit recovery key'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Choose how BitLocker-protected operating system drives can be recovered: Recovery Key' is set to 'Enabled: Do not allow 256-bit recovery key'. Expected state per CIS Intune benchmark: Enabled: Do not allow 256-bit recovery key."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\OSRecoveryKey Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\OSRecoveryKey' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:choose-how-bitlocker-protected-operating-system-drives-can-be-recovered-recovery-key-is-enabled-do-not-allow-256-bit-rec, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Choose how BitLocker-protected operating system drives can be recovered: Recovery Password' is set to 'Enabled: Require 48-digit recovery password'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Choose how BitLocker-protected operating system drives can be recovered: Recovery Password' is set to 'Enabled: Require 48-digit recovery password'. Expected state per CIS Intune benchmark: Enabled: Require 48-digit recovery password."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\OSRecoveryPassword Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\OSRecoveryPassword' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:choose-how-bitlocker-protected-operating-system-drives-can-be-recovered-recovery-password-is-enabled-require-48-digit-re, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Choose how BitLocker-protected operating system drives can be recovered: Allow data recovery agent' is set to 'Enabled: False'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Choose how BitLocker-protected operating system drives can be recovered: Allow data recovery agent' is set to 'Enabled: False'. Expected state per CIS Intune benchmark: Enabled: False."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\OSAllowDRA Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\OSAllowDRA' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:choose-how-bitlocker-protected-operating-system-drives-can-be-recovered-allow-data-recovery-agent-is-enabled-false, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Choose how BitLocker-protected operating system drives can be recovered: Configure storage of BitLocker recovery information to AD DS:' is set to 'Enabled: Store recovery passwords and key packages'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Choose how BitLocker-protected operating system drives can be recovered: Configure storage of BitLocker recovery information to AD DS:' is set to 'Enabled: Store recovery passwords and key packages'. Expected state per CIS Intune benchmark: Enabled: Store recovery passwords and key packages."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\OSActiveDirectoryBackup Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\OSActiveDirectoryBackup' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:choose-how-bitlocker-protected-operating-system-drives-can-be-recovered-configure-storage-of-bitlocker-recovery-informat, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Choose how BitLocker-protected operating system drives can be recovered: Do not enable BitLocker until recovery information is stored to AD DS for operating system drives' is set to 'Enabled: True'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Choose how BitLocker-protected operating system drives can be recovered: Do not enable BitLocker until recovery information is stored to AD DS for operating system drives' is set to 'Enabled: True'. Expected state per CIS Intune benchmark: Enabled: True."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\OSRequireActiveDirectoryBackup Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\OSRequireActiveDirectoryBackup' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:choose-how-bitlocker-protected-operating-system-drives-can-be-recovered-do-not-enable-bitlocker-until-recovery-informati, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Choose how BitLocker-protected operating system drives can be recovered: Omit recovery options from the BitLocker setup wizard' is set to 'Enabled: True'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Choose how BitLocker-protected operating system drives can be recovered: Omit recovery options from the BitLocker setup wizard' is set to 'Enabled: True'. Expected state per CIS Intune benchmark: Enabled: True."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\OSHideRecoveryPage Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\OSHideRecoveryPage' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:choose-how-bitlocker-protected-operating-system-drives-can-be-recovered-omit-recovery-options-from-the-bitlocker-setup-w, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Choose how BitLocker-protected operating system drives can be recovered: Save BitLocker recovery information to AD DS for operating system drives' is set to 'Enabled: True'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Choose how BitLocker-protected operating system drives can be recovered: Save BitLocker recovery information to AD DS for operating system drives' is set to 'Enabled: True'. Expected state per CIS Intune benchmark: Enabled: True."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\OSActiveDirectoryBackup Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\OSActiveDirectoryBackup' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:choose-how-bitlocker-protected-operating-system-drives-can-be-recovered-save-bitlocker-recovery-information-to-ad-ds-for, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Require additional authentication at startup: Configure TPM startup key and PIN:' is set to 'Enabled: Do not allow startup key and PIN with TPM'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Require additional authentication at startup: Configure TPM startup key and PIN:' is set to 'Enabled: Do not allow startup key and PIN with TPM'. Expected state per CIS Intune benchmark: Enabled: Do not allow startup key and PIN with TPM."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\UseTPM Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\UseTPM' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:require-additional-authentication-at-startup-configure-tpm-startup-key-and-pin-is-enabled-do-not-allow-startup-key-and-p, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Require additional authentication at startup: Configure TPM startup key:' is set to 'Enabled: Do not allow startup key with TPM'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Require additional authentication at startup: Configure TPM startup key:' is set to 'Enabled: Do not allow startup key with TPM'. Expected state per CIS Intune benchmark: Enabled: Do not allow startup key with TPM."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\UseTPM Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\UseTPM' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:require-additional-authentication-at-startup-configure-tpm-startup-key-is-enabled-do-not-allow-startup-key-with-tpm, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Require additional authentication at startup: Configure TPM startup PIN:' is set to 'Enabled: Require startup PIN with TPM'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Require additional authentication at startup: Configure TPM startup PIN:' is set to 'Enabled: Require startup PIN with TPM'. Expected state per CIS Intune benchmark: Enabled: Require startup PIN with TPM."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\UseTPM Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\UseTPM' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:require-additional-authentication-at-startup-configure-tpm-startup-pin-is-enabled-require-startup-pin-with-tpm, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Require additional authentication at startup: Configure TPM startup:' is set to 'Enabled: Do not allow TPM'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Require additional authentication at startup: Configure TPM startup:' is set to 'Enabled: Do not allow TPM'. Expected state per CIS Intune benchmark: Enabled: Do not allow TPM."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\UseTPM Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\UseTPM' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:require-additional-authentication-at-startup-configure-tpm-startup-is-enabled-do-not-allow-tpm, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Enforce drive encryption type on operating system drives: Select the encryption type: (device)' is set to 'Enabled: Used Space Only encryption'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enforce drive encryption type on operating system drives: Select the encryption type: (device)' is set to 'Enabled: Used Space Only encryption'. Expected state per CIS Intune benchmark: Enabled: Used Space Only encryption."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: device Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'device' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:enforce-drive-encryption-type-on-operating-system-drives-select-the-encryption-type-device-is-enabled-used-space-only-en, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Deny write access to removable drives not protected by BitLocker' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Deny write access to removable drives not protected by BitLocker' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\RDVDenyWriteAccess Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\RDVDenyWriteAccess' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:deny-write-access-to-removable-drives-not-protected-by-bitlocker-is-enabled, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Deny write access to removable drives not protected by BitLocker: Do not allow write access to devices configured in another organization' is set to 'Enabled: False'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Deny write access to removable drives not protected by BitLocker: Do not allow write access to devices configured in another organization' is set to 'Enabled: False'. Expected state per CIS Intune benchmark: Enabled: False."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\RDVDenyCrossOrg Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\RDVDenyCrossOrg' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:deny-write-access-to-removable-drives-not-protected-by-bitlocker-do-not-allow-write-access-to-devices-configured-in-anot, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Choose drive encryption method and cipher strength (Windows 10 [Version 1511] and later): Select the encryption method for fixed data drives' is set to 'XTS-AES 128-bit (default)'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Choose drive encryption method and cipher strength (Windows 10 [Version 1511] and later): Select the encryption method for fixed data drives' is set to 'XTS-AES 128-bit (default)'. Expected state per CIS Intune benchmark: XTS-AES 128-bit (default)."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\FDVEncryptionType Condition: data = '6'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\FDVEncryptionType' AND data = '6';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:choose-drive-encryption-method-and-cipher-strength-windows-10-version-1511-and-later-select-the-encryption-method-for-fi, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Choose drive encryption method and cipher strength (Windows 10 [Version 1511] and later): Select the encryption method for operating system drives' is set to 'XTS-AES 128-bit (default)'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Choose drive encryption method and cipher strength (Windows 10 [Version 1511] and later): Select the encryption method for operating system drives' is set to 'XTS-AES 128-bit (default)'. Expected state per CIS Intune benchmark: XTS-AES 128-bit (default)."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\OSEncryptionType Condition: data = '6'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\OSEncryptionType' AND data = '6';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:choose-drive-encryption-method-and-cipher-strength-windows-10-version-1511-and-later-select-the-encryption-method-for-op, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Choose drive encryption method and cipher strength (Windows 10 [Version 1511] and later): Select the encryption method for removable data drives' is set to 'XTS-AES 128-bit'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Choose drive encryption method and cipher strength (Windows 10 [Version 1511] and later): Select the encryption method for removable data drives' is set to 'XTS-AES 128-bit'. Expected state per CIS Intune benchmark: XTS-AES 128-bit."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\RDVEncryptionType Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\RDVEncryptionType' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:choose-drive-encryption-method-and-cipher-strength-windows-10-version-1511-and-later-select-the-encryption-method-for-re, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Prevent the use of security questions for local accounts' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Prevent the use of security questions for local accounts' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\NoLocalPasswordResetQuestions Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\NoLocalPasswordResetQuestions' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:prevent-the-use-of-security-questions-for-local-accounts-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security\\Retention Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security\Retention' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:control-event-log-behavior-when-the-log-file-reaches-its-maximum-size-is-disabled, cis_safeguard_id:CIS8.2
  purpose: Enforcement
- name: CIS - Ensure 'Specify the maximum log file size (KB)' is set to 'Enabled: 32,768 or greater'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Specify the maximum log file size (KB)' is set to 'Enabled: 32,768 or greater'. Expected state per CIS Intune benchmark: Enabled: 32,768 or greater."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: KB Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'KB' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:specify-the-maximum-log-file-size-kb-is-enabled-32768-or-greater, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Specify the maximum log file size (KB)' is set to 'Enabled: 196,608 or greater'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Specify the maximum log file size (KB)' is set to 'Enabled: 196,608 or greater'. Expected state per CIS Intune benchmark: Enabled: 196,608 or greater."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: KB Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'KB' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:security, requirement:standard, critical:false, control:specify-the-maximum-log-file-size-kb-is-enabled-196608-or-greater, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Configure Windows Defender SmartScreen' is set to 'Enabled: Warn and prevent bypass'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Configure Windows Defender SmartScreen' is set to 'Enabled: Warn and prevent bypass'. Expected state per CIS Intune benchmark: Enabled: Warn and prevent bypass."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\EnableSmartScreen Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\EnableSmartScreen' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:configure-windows-defender-smartscreen-is-enabled-warn-and-prevent-bypass, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Block all consumer Microsoft account user authentication' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Block all consumer Microsoft account user authentication' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftAccount\\DisableUserAuth Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftAccount\\DisableUserAuth' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:accounts, requirement:standard, critical:false, control:block-all-consumer-microsoft-account-user-authentication-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Configure local setting override for reporting to Microsoft MAPS' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Configure local setting override for reporting to Microsoft MAPS' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\LocalSettingOverrideSpynetReporting Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\LocalSettingOverrideSpynetReporting' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:configure-local-setting-override-for-reporting-to-microsoft-maps-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Prevent users from sharing files within their profile. (User)' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Prevent users from sharing files within their profile. (User)' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: User Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'User' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:network, requirement:standard, critical:false, control:prevent-users-from-sharing-files-within-their-profile-user-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow users to connect remotely by using Remote Desktop Services' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow users to connect remotely by using Remote Desktop Services' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\fDenyTSConnections Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\fDenyTSConnections' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-users-to-connect-remotely-by-using-remote-desktop-services-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Do not allow supported Plug and Play device redirection' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Do not allow supported Plug and Play device redirection' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\fDisablePNPRedir Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\fDisablePNPRedir' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:do-not-allow-supported-plug-and-play-device-redirection-is-enabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Restrict clipboard transfer from server to client' is set to 'Enabled: Disable clipboard transfers from server to client'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Restrict clipboard transfer from server to client' is set to 'Enabled: Disable clipboard transfers from server to client'. Expected state per CIS Intune benchmark: Enabled: Disable clipboard transfers from server to client."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\fDisableClip Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\fDisableClip' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:restrict-clipboard-transfer-from-server-to-client-is-enabled-disable-clipboard-transfers-from-server-to-client, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Require use of specific security layer for remote (RDP) connections' is set to 'Enabled: SSL'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Require use of specific security layer for remote (RDP) connections' is set to 'Enabled: SSL'. Expected state per CIS Intune benchmark: Enabled: SSL."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: RDP Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'RDP' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:require-use-of-specific-security-layer-for-remote-rdp-connections-is-enabled-ssl, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Require user authentication for remote connections by using Network Level Authentication' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Require user authentication for remote connections by using Network Level Authentication' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\\UserAuthentication Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\\UserAuthentication' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:require-user-authentication-for-remote-connections-by-using-network-level-authentication-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Set client connection encryption level' is set to 'Enabled: High Level'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Set client connection encryption level' is set to 'Enabled: High Level'. Expected state per CIS Intune benchmark: Enabled: High Level."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\MinEncryptionLevel Condition: data = '3'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\MinEncryptionLevel' AND data = '3';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:set-client-connection-encryption-level-is-enabled-high-level, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Set time limit for active but idle Remote Desktop Services sessions' is set to 'Enabled: 15 minutes or less, but not Never (0)'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Set time limit for active but idle Remote Desktop Services sessions' is set to 'Enabled: 15 minutes or less, but not Never (0)'. Expected state per CIS Intune benchmark: Enabled: 15 minutes or less, but not Never (0)."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: 0 Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = '0' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:time, requirement:standard, critical:false, control:set-time-limit-for-active-but-idle-remote-desktop-services-sessions-is-enabled-15-minutes-or-less-but-not-never-0, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Set time limit for disconnected sessions' is set to 'Enabled: 1 minute'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Set time limit for disconnected sessions' is set to 'Enabled: 1 minute'. Expected state per CIS Intune benchmark: Enabled: 1 minute."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\MaxDisconnectionTime Condition: data = '60000'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services\\MaxDisconnectionTime' AND data = '60000';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:session, requirement:standard, critical:false, control:set-time-limit-for-disconnected-sessions-is-enabled-1-minute, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Turn off the offer to update to the latest version of Windows' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Turn off the offer to update to the latest version of Windows' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\DisableOSUpgrade Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\DisableOSUpgrade' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:turn-off-the-offer-to-update-to-the-latest-version-of-windows-is-enabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Prevent Internet Explorer security prompt for Windows Installer scripts' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Prevent Internet Explorer security prompt for Windows Installer scripts' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_WINDOW_RESTRICTIONS Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_WINDOW_RESTRICTIONS' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:prevent-internet-explorer-security-prompt-for-windows-installer-scripts-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Sign-in and lock last interactive user automatically after a restart' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Sign-in and lock last interactive user automatically after a restart' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableAutomaticRestartSignOn Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableAutomaticRestartSignOn' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:sign-in-and-lock-last-interactive-user-automatically-after-a-restart-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Account Management Audit Application Group Management' is set to 'Success and Failure'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Account Management Audit Application Group Management' is set to 'Success and Failure'. Expected state per CIS Intune benchmark: Success and Failure."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\ApplicationGroupManagement Condition: data = '3'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\ApplicationGroupManagement' AND data = '3';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:accounts, requirement:standard, critical:false, control:account-management-audit-application-group-management-is-success-and-failure, cis_safeguard_id:CIS8.2
  purpose: Enforcement
- name: CIS - Ensure 'Object Access Audit Other Object Access Events' is set to 'Success and Failure'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Object Access Audit Other Object Access Events' is set to 'Success and Failure'. Expected state per CIS Intune benchmark: Success and Failure."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\OtherObjectAccessEvents Condition: data = '3'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\OtherObjectAccessEvents' AND data = '3';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:network, requirement:standard, critical:false, control:object-access-audit-other-object-access-events-is-success-and-failure, cis_safeguard_id:CIS8.2
  purpose: Enforcement
- name: CIS - Ensure 'Policy Change Audit MPSSVC Rule Level Policy Change' is set to 'Success and Failure'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Policy Change Audit MPSSVC Rule Level Policy Change' is set to 'Success and Failure'. Expected state per CIS Intune benchmark: Success and Failure."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\MPSSVCRuleLevelPolicyChange Condition: data = '3'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Audit\\MPSSVCRuleLevelPolicyChange' AND data = '3';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:policy-change-audit-mpssvc-rule-level-policy-change-is-success-and-failure, cis_safeguard_id:CIS8.2
  purpose: Enforcement
- name: CIS - Ensure 'Allow Warning For Other Disk Encryption: Allow Standard User Encryption' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Warning For Other Disk Encryption: Allow Standard User Encryption' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\AllowStandardUserEncryption Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\AllowStandardUserEncryption' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:BL, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-warning-for-other-disk-encryption-allow-standard-user-encryption-is-enabled, cis_safeguard_id:CIS3.4
  purpose: Enforcement
  - name: CIS - Ensure 'ASR: Block all Office applications from creating child processes' is set to 'Audit'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'ASR: Block all Office applications from creating child processes' is set to 'Audit'. Expected state per CIS Intune benchmark: Audit."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules\\d4f940ab-401b-4efc-aadc-ad5f3c50688a Condition: data = '2'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\d4f940ab-401b-4efc-aadc-ad5f3c50688a' AND data = '2';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:asr-block-all-office-applications-from-creating-child-processes-is-audit, cis_safeguard_id:CIS8.2
  purpose: Enforcement
- name: CIS - Ensure 'ASR: Block credential stealing from the Windows local security authority subsystem' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'ASR: Block credential stealing from the Windows local security authority subsystem' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules\\9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2 Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:asr-block-credential-stealing-from-the-windows-local-security-authority-subsystem-is-block, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'ASR: Block executable content from email client and webmail' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'ASR: Block executable content from email client and webmail' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules\\be9ba2d9-53ea-4cdc-84e5-9b1eeee46550 Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\be9ba2d9-53ea-4cdc-84e5-9b1eeee46550' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:asr-block-executable-content-from-email-client-and-webmail-is-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'ASR: Block executable files from running unless they meet a prevalence, age, or trusted list criterion' is set to 'Audit'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'ASR: Block executable files from running unless they meet a prevalence, age, or trusted list criterion' is set to 'Audit'. Expected state per CIS Intune benchmark: Audit."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules\\01443614-cd74-433a-b99e-2ecdc07bfc25 Condition: data = '2'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\01443614-cd74-433a-b99e-2ecdc07bfc25' AND data = '2';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:asr-block-executable-files-from-running-unless-they-meet-a-prevalence-age-or-trusted-list-criterion-is-audit, cis_safeguard_id:CIS8.2
  purpose: Enforcement
- name: CIS - Ensure 'ASR: Block JavaScript or VBScript from launching downloaded executable content' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'ASR: Block JavaScript or VBScript from launching downloaded executable content' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules\\d3e037e1-3eb8-44c8-a917-57927947596d Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\d3e037e1-3eb8-44c8-a917-57927947596d' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:asr-block-javascript-or-vbscript-from-launching-downloaded-executable-content-is-block, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'ASR: Block Office applications from creating executable content' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'ASR: Block Office applications from creating executable content' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules\\3b576869-a4ec-4529-8536-b80a7769e899 Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\3b576869-a4ec-4529-8536-b80a7769e899' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:asr-block-office-applications-from-creating-executable-content-is-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'ASR: Block Office applications from injecting code into other processes' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'ASR: Block Office applications from injecting code into other processes' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules\\75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84 Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:asr-block-office-applications-from-injecting-code-into-other-processes-is-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'ASR: Block Office communication application from creating child processes' is set to 'Audit'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'ASR: Block Office communication application from creating child processes' is set to 'Audit'. Expected state per CIS Intune benchmark: Audit."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules\\26190899-1602-49e8-8b27-eb1d0a1ce869 Condition: data = '2'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\26190899-1602-49e8-8b27-eb1d0a1ce869' AND data = '2';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:asr-block-office-communication-application-from-creating-child-processes-is-audit, cis_safeguard_id:CIS8.2
  purpose: Enforcement
- name: CIS - Ensure 'ASR: Block process creations originating from PSExec and WMI commands' is set to 'Audit'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'ASR: Block process creations originating from PSExec and WMI commands' is set to 'Audit'. Expected state per CIS Intune benchmark: Audit."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules\\d1e49aac-8f56-4280-b9ba-993a6d77406c Condition: data = '2'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\d1e49aac-8f56-4280-b9ba-993a6d77406c' AND data = '2';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:asr-block-process-creations-originating-from-psexec-and-wmi-commands-is-audit, cis_safeguard_id:CIS8.2
  purpose: Enforcement
- name: CIS - Ensure 'ASR: Block untrusted and unsigned processes that run from USB' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'ASR: Block untrusted and unsigned processes that run from USB' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules\\b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4 Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR\Rules\b2b3f03d-6a65-4f7b-a9c7-1c7ef74a9ba4' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:asr-block-untrusted-and-unsigned-processes-that-run-from-usb-is-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Enable Convert Warn To Block' is set to 'Warn verdicts are converted to block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Convert Warn To Block' is set to 'Warn verdicts are converted to block'. Expected state per CIS Intune benchmark: Warn verdicts are converted to block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Threats\\ConvertWarnToBlock Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Threats\\ConvertWarnToBlock' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-convert-warn-to-block-is-warn-verdicts-are-converted-to-block, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Remote Encryption Protection Configured State' is set to 'Audit: Generate EDR detections without blocking'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Remote Encryption Protection Configured State' is set to 'Audit: Generate EDR detections without blocking'. Expected state per CIS Intune benchmark: Audit: Generate EDR detections without blocking."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\RemoteEncryptionProtectionConfiguredState Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\FVE\\RemoteEncryptionProtectionConfiguredState' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:remote-encryption-protection-configured-state-is-audit-generate-edr-detections-without-blocking, cis_safeguard_id:CIS3.4
  purpose: Enforcement
- name: CIS - Ensure 'Configure System Guard Launch' is set to 'Unmanaged Enables Secure Launch if supported by hardware'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Configure System Guard Launch' is set to 'Unmanaged Enables Secure Launch if supported by hardware'. Expected state per CIS Intune benchmark: Unmanaged Enables Secure Launch if supported by hardware."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\EnableSecureLaunch Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System\\EnableSecureLaunch' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:configure-system-guard-launch-is-unmanaged-enables-secure-launch-if-supported-by-hardware, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Virtualization Based Security' is set to 'Enable virtualization based security'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Virtualization Based Security' is set to 'Enable virtualization based security'. Expected state per CIS Intune benchmark: Enable virtualization based security."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\DeviceGuard\\EnableVirtualizationBasedSecurity Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\DeviceGuard\\EnableVirtualizationBasedSecurity' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-virtualization-based-security-is-enable-virtualization-based-security, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Require Platform Security Features' is set to 'Turns on VBS with Secure Boot'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Require Platform Security Features' is set to 'Turns on VBS with Secure Boot'. Expected state per CIS Intune benchmark: Turns on VBS with Secure Boot."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\DeviceGuard\\RequirePlatformSecurityFeatures Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\DeviceGuard\\RequirePlatformSecurityFeatures' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:require-platform-security-features-is-turns-on-vbs-with-secure-boot, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Device Password Enabled: Alphanumeric Device Password Required' is set to 'Password or Alphanumeric PIN required'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Device Password Enabled: Alphanumeric Device Password Required' is set to 'Password or Alphanumeric PIN required'. Expected state per CIS Intune benchmark: Password or Alphanumeric PIN required."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\DevicePasswordEnabled Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\DevicePasswordEnabled' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:authn, requirement:standard, critical:false, control:device-password-enabled-alphanumeric-device-password-required-is-password-or-alphanumeric-pin-required, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Device Password Enabled: Min Device Password Complex Characters' is set to 'Digits and lowercase letters are required'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Device Password Enabled: Min Device Password Complex Characters' is set to 'Digits and lowercase letters are required'. Expected state per CIS Intune benchmark: Digits and lowercase letters are required."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\MinDevicePasswordComplexCharacters Condition: data LIKE '%'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\MinDevicePasswordComplexCharacters' AND data LIKE '%';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:accounts, requirement:standard, critical:false, control:device-password-enabled-min-device-password-complex-characters-is-digits-and-lowercase-letters-are-required, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Device Password Enabled: Device Password Expiration' is set to '365 or fewer days, but not 0'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Device Password Enabled: Device Password Expiration' is set to '365 or fewer days, but not 0'. Expected state per CIS Intune benchmark: 365 or fewer days, but not 0."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\DevicePasswordExpirationDays Condition: data = '365'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\DevicePasswordExpirationDays' AND data = '365';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:accounts, requirement:standard, critical:false, control:device-password-enabled-device-password-expiration-is-365-or-fewer-days-but-not-0, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Device Password Enabled: Device Password History' is set to '24 or more password(s)'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Device Password Enabled: Device Password History' is set to '24 or more password(s)'. Expected state per CIS Intune benchmark: 24 or more password(s)."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\DevicePasswordHistory Condition: data = '24'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\DevicePasswordHistory' AND data = '24';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:authn, requirement:standard, critical:false, control:device-password-enabled-device-password-history-is-24-or-more-passwords, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Device Password Enabled: Max Device Password Failed Attempts' is set to '5 or fewer failed attempt(s), but not 0'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Device Password Enabled: Max Device Password Failed Attempts' is set to '5 or fewer failed attempt(s), but not 0'. Expected state per CIS Intune benchmark: 5 or fewer failed attempt(s), but not 0."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\MaxDevicePasswordFailedAttempts Condition: data = '5'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\MaxDevicePasswordFailedAttempts' AND data = '5';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:accounts, requirement:standard, critical:false, control:device-password-enabled-max-device-password-failed-attempts-is-5-or-fewer-failed-attempts-but-not-0, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Device Password Enabled: Max Inactivity Time Device Lock' is set to '15 or fewer minutes, but not 0'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Device Password Enabled: Max Inactivity Time Device Lock' is set to '15 or fewer minutes, but not 0'. Expected state per CIS Intune benchmark: 15 or fewer minutes, but not 0."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\MaxInactivityTimeDeviceLock Condition: data = '15'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\MaxInactivityTimeDeviceLock' AND data = '15';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:session, requirement:standard, critical:false, control:device-password-enabled-max-inactivity-time-device-lock-is-15-or-fewer-minutes-but-not-0, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Device Password Enabled: Min Device Password Length' is set to '14 or more character(s)'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Device Password Enabled: Min Device Password Length' is set to '14 or more character(s)'. Expected state per CIS Intune benchmark: 14 or more character(s)."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\MinDevicePasswordLength Condition: data = '14'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\MinDevicePasswordLength' AND data = '14';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:session, requirement:standard, critical:false, control:device-password-enabled-min-device-password-length-is-14-or-more-characters, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Do not show feedback notifications' is set to 'Feedback notifications are disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Do not show feedback notifications' is set to 'Feedback notifications are disabled'. Expected state per CIS Intune benchmark: Feedback notifications are disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection\\DoNotShowFeedbackNotifications Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection\\DoNotShowFeedbackNotifications' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:accounts, requirement:standard, critical:false, control:do-not-show-feedback-notifications-is-feedback-notifications-are-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Enable Domain Network Firewall: Default Inbound Action for Domain Profile' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Domain Network Firewall: Default Inbound Action for Domain Profile' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\EnableFirewall Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\EnableFirewall' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-domain-network-firewall-default-inbound-action-for-domain-profile-is-block, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Domain Network Firewall: Disable Inbound Notifications' is set to 'True'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Domain Network Firewall: Disable Inbound Notifications' is set to 'True'. Expected state per CIS Intune benchmark: True."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\EnableFirewall Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\EnableFirewall' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-domain-network-firewall-disable-inbound-notifications-is-true, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Domain Network Firewall: Enable Log Dropped Packets' is set to 'Yes: Enable Logging Of Dropped Packets'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Domain Network Firewall: Enable Log Dropped Packets' is set to 'Yes: Enable Logging Of Dropped Packets'. Expected state per CIS Intune benchmark: Yes: Enable Logging Of Dropped Packets."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\EnableFirewall Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\EnableFirewall' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-domain-network-firewall-enable-log-dropped-packets-is-yes-enable-logging-of-dropped-packets, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Domain Network Firewall: Enable Log Success Connections' is set to 'Enable Logging Of Successful Connections'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Domain Network Firewall: Enable Log Success Connections' is set to 'Enable Logging Of Successful Connections'. Expected state per CIS Intune benchmark: Enable Logging Of Successful Connections."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\EnableFirewall Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\EnableFirewall' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-domain-network-firewall-enable-log-success-connections-is-enable-logging-of-successful-connections, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Domain Network Firewall: Log File Path' is set to '%SystemRoot%\System32\logfiles\firewall\domainfw.log'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Domain Network Firewall: Log File Path' is set to '%SystemRoot%\\System32\\logfiles\\firewall\\domainfw.log'. Expected state per CIS Intune benchmark: %SystemRoot%\\System32\\logfiles\\firewall\\domainfw.log."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\LogFilePath Condition: data LIKE '%%systemroot%\\system32\\logfiles\\firewall\\domainfw.log%'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\DomainProfile\LogFilePath' AND data LIKE '%%systemroot%\system32\logfiles\firewall\domainfw.log%';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-domain-network-firewall-log-file-path-is-systemroot-system32-logfiles-firewall-domainfw-log, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Domain Network Firewall: Log Max File Size' is set to '16,384 KB or greater'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Domain Network Firewall: Log Max File Size' is set to '16,384 KB or greater'. Expected state per CIS Intune benchmark: 16,384 KB or greater."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\LogFileSize Condition: data = '16384'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\DomainProfile\LogFileSize' AND data = '16384';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-domain-network-firewall-log-max-file-size-is-16384-kb-or-greater, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Private Network Firewall: Default Inbound Action for Private Profile' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Private Network Firewall: Default Inbound Action for Private Profile' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\EnableFirewall Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\EnableFirewall' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-private-network-firewall-default-inbound-action-for-private-profile-is-block, cis_safeguard_id:CIS4.1
  purpose: Enforcement
  - name: CIS - Ensure 'Enable Private Network Firewall: Disable Inbound Notifications' is set to 'True'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Private Network Firewall: Disable Inbound Notifications' is set to 'True'. Expected state per CIS Intune benchmark: True."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\EnableFirewall Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\EnableFirewall' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-private-network-firewall-disable-inbound-notifications-is-true, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Private Network Firewall: Enable Log Success Connections' is set to 'Enable Logging Of Successful Connections'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Private Network Firewall: Enable Log Success Connections' is set to 'Enable Logging Of Successful Connections'. Expected state per CIS Intune benchmark: Enable Logging Of Successful Connections."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\EnableFirewall Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\EnableFirewall' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-private-network-firewall-enable-log-success-connections-is-enable-logging-of-successful-connections, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Private Network Firewall: Enable Log Dropped Packets' is set to 'Yes: Enable Logging Of Dropped Packets'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Private Network Firewall: Enable Log Dropped Packets' is set to 'Yes: Enable Logging Of Dropped Packets'. Expected state per CIS Intune benchmark: Yes: Enable Logging Of Dropped Packets."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\EnableFirewall Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\EnableFirewall' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-private-network-firewall-enable-log-dropped-packets-is-yes-enable-logging-of-dropped-packets, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Private Network Firewall: Log File Path' is set to '%SystemRoot%\System32\logfiles\firewall\privatefw.log'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Private Network Firewall: Log File Path' is set to '%SystemRoot%\\System32\\logfiles\\firewall\\privatefw.log'. Expected state per CIS Intune benchmark: %SystemRoot%\\System32\\logfiles\\firewall\\privatefw.log."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\LogFilePath Condition: data LIKE '%%systemroot%\\system32\\logfiles\\firewall\\privatefw.log%'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\StandardProfile\LogFilePath' AND data LIKE '%%systemroot%\system32\logfiles\firewall\privatefw.log%';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-private-network-firewall-log-file-path-is-systemroot-system32-logfiles-firewall-privatefw-log, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Private Network Firewall: Log Max File Size' is set to '16,384 KB or greater'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Private Network Firewall: Log Max File Size' is set to '16,384 KB or greater'. Expected state per CIS Intune benchmark: 16,384 KB or greater."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\LogFileSize Condition: data = '16384'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\StandardProfile\LogFileSize' AND data = '16384';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-private-network-firewall-log-max-file-size-is-16384-kb-or-greater, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Public Network Firewall: Allow Local Ipsec Policy Merge' is set to 'False'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Public Network Firewall: Allow Local Ipsec Policy Merge' is set to 'False'. Expected state per CIS Intune benchmark: False."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\EnableFirewall Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\EnableFirewall' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-public-network-firewall-allow-local-ipsec-policy-merge-is-false, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Public Network Firewall: Default Inbound Action for Public Profile' is set to 'Block'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Public Network Firewall: Default Inbound Action for Public Profile' is set to 'Block'. Expected state per CIS Intune benchmark: Block."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\EnableFirewall Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\EnableFirewall' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-public-network-firewall-default-inbound-action-for-public-profile-is-block, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Public Network Firewall: Disable Inbound Notifications' is set to 'True'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Public Network Firewall: Disable Inbound Notifications' is set to 'True'. Expected state per CIS Intune benchmark: True."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\EnableFirewall Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\EnableFirewall' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-public-network-firewall-disable-inbound-notifications-is-true, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Public Network Firewall: Enable Log Dropped Packets' is set to 'Yes: Enable Logging Of Dropped Packets'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Public Network Firewall: Enable Log Dropped Packets' is set to 'Yes: Enable Logging Of Dropped Packets'. Expected state per CIS Intune benchmark: Yes: Enable Logging Of Dropped Packets."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\EnableFirewall Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\EnableFirewall' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-public-network-firewall-enable-log-dropped-packets-is-yes-enable-logging-of-dropped-packets, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Public Network Firewall: Enable Log Success Connections' is set to 'Enable Logging Of Successful Connections'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Public Network Firewall: Enable Log Success Connections' is set to 'Enable Logging Of Successful Connections'. Expected state per CIS Intune benchmark: Enable Logging Of Successful Connections."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\EnableFirewall Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\EnableFirewall' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-public-network-firewall-enable-log-success-connections-is-enable-logging-of-successful-connections, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Public Network Firewall: Log File Path' is set to '%SystemRoot%\System32\logfiles\firewall\publicfw.log'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Public Network Firewall: Log File Path' is set to '%SystemRoot%\\System32\\logfiles\\firewall\\publicfw.log'. Expected state per CIS Intune benchmark: %SystemRoot%\\System32\\logfiles\\firewall\\publicfw.log."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\LogFilePath Condition: data LIKE '%%systemroot%\\system32\\logfiles\\firewall\\publicfw.log%'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\PublicProfile\LogFilePath' AND data LIKE '%%systemroot%\system32\logfiles\firewall\publicfw.log%';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-public-network-firewall-log-file-path-is-systemroot-system32-logfiles-firewall-publicfw-log, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Enable Public Network Firewall: Log Max File Size' is set to '16,384 KB or greater'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable Public Network Firewall: Log Max File Size' is set to '16,384 KB or greater'. Expected state per CIS Intune benchmark: 16,384 KB or greater."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\LogFileSize Condition: data = '16384'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\PublicProfile\LogFileSize' AND data = '16384';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-public-network-firewall-log-max-file-size-is-16384-kb-or-greater, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Accounts: Limit local account use of blank passwords to console logon only' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Accounts: Limit local account use of blank passwords to console logon only' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\LimitBlankPasswordUse Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\LimitBlankPasswordUse' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:accounts, requirement:standard, critical:false, control:accounts-limit-local-account-use-of-blank-passwords-to-console-logon-only-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Devices: Prevent users from installing printer drivers when connecting to shared printers' is set to 'Enable'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Devices: Prevent users from installing printer drivers when connecting to shared printers' is set to 'Enable'. Expected state per CIS Intune benchmark: Enable."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\DisableUserInstalls Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\\DisableUserInstalls' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:accounts, requirement:standard, critical:false, control:devices-prevent-users-from-installing-printer-drivers-when-connecting-to-shared-printers-is-enable, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Interactive logon: Machine inactivity limit' is set to '900 or fewer second(s), but not 0'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Interactive logon: Machine inactivity limit' is set to '900 or fewer second(s), but not 0'. Expected state per CIS Intune benchmark: 900 or fewer second(s), but not 0."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\InactivityTimeoutSecs Condition: data = '900'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\InactivityTimeoutSecs' AND data = '900';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:interactive-logon-machine-inactivity-limit-is-900-or-fewer-seconds-but-not-0, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Microsoft network client: Digitally sign communications (always)' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Microsoft network client: Digitally sign communications (always)' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: always Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'always' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:session, requirement:standard, critical:false, control:microsoft-network-client-digitally-sign-communications-always-is-enabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Microsoft network client: Digitally sign communications (if server agrees)' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Microsoft network client: Digitally sign communications (if server agrees)' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: if server agrees Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'if server agrees' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:microsoft-network-client-digitally-sign-communications-if-server-agrees-is-enabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Microsoft network client: Send unencrypted password to third-party SMB servers' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Microsoft network client: Send unencrypted password to third-party SMB servers' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters\\EnablePlainTextPassword Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters\\EnablePlainTextPassword' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:microsoft-network-client-send-unencrypted-password-to-third-party-smb-servers-is-disabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Microsoft network server: Digitally sign communications (always)' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Microsoft network server: Digitally sign communications (always)' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: always Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'always' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:microsoft-network-server-digitally-sign-communications-always-is-enabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Microsoft network server: Digitally sign communications (if client agrees)' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Microsoft network server: Digitally sign communications (if client agrees)' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: if client agrees Condition: start_type != 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'if client agrees' AND start_type != 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:microsoft-network-server-digitally-sign-communications-if-client-agrees-is-enabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Network access: Do not allow anonymous enumeration of SAM accounts' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Network access: Do not allow anonymous enumeration of SAM accounts' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\RestrictAnonymous Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\RestrictAnonymous' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:network-access-do-not-allow-anonymous-enumeration-of-sam-accounts-is-enabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Network access: Do not allow anonymous enumeration of SAM accounts and shares' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Network access: Do not allow anonymous enumeration of SAM accounts and shares' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\RestrictAnonymous Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\RestrictAnonymous' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:network-access-do-not-allow-anonymous-enumeration-of-sam-accounts-and-shares-is-enabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Network access: Restrict anonymous access to Named Pipes and Shares' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Network access: Restrict anonymous access to Named Pipes and Shares' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\\RestrictNullSessAccess Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\\RestrictNullSessAccess' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:network-access-restrict-anonymous-access-to-named-pipes-and-shares-is-enabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Network access: Restrict clients allowed to make remote calls to SAM' is set to 'Administrators: Remote Access: Allow'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Network access: Restrict clients allowed to make remote calls to SAM' is set to 'Administrators: Remote Access: Allow'. Expected state per CIS Intune benchmark: Administrators: Remote Access: Allow."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\RestrictRemoteSAM Condition: data LIKE '%Administrators%'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\RestrictRemoteSAM' AND data LIKE '%Administrators%';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:network-access-restrict-clients-allowed-to-make-remote-calls-to-sam-is-administrators-remote-access-allow, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Network security: Allow Local System to use computer identity for NTLM' is set to 'Allow'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Network security: Allow Local System to use computer identity for NTLM' is set to 'Allow'. Expected state per CIS Intune benchmark: Allow."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\UseMachineId Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\UseMachineId' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:network-security-allow-local-system-to-use-computer-identity-for-ntlm-is-allow, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Network security: Do not store LAN Manager hash value on next password change' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Network security: Do not store LAN Manager hash value on next password change' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\NoLMHash Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\NoLMHash' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:network-security-do-not-store-lan-manager-hash-value-on-next-password-change-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Network security: LAN Manager authentication level' is set to 'Send LM and NTLMv2 responses only. Refuse LM and NTLM'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Network security: LAN Manager authentication level' is set to 'Send LM and NTLMv2 responses only. Refuse LM and NTLM'. Expected state per CIS Intune benchmark: Send LM and NTLMv2 responses only. Refuse LM and NTLM."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\LmCompatibilityLevel Condition: data = '5'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\LmCompatibilityLevel' AND data = '5';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:network-security-lan-manager-authentication-level-is-send-lm-and-ntlmv2-responses-only-refuse-lm-and-ntlm, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Network Security Minimum Session Security For NTLMSSP Based Clients' is set to 'Require NTLM and 128-bit encryption'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Network Security Minimum Session Security For NTLMSSP Based Clients' is set to 'Require NTLM and 128-bit encryption'. Expected state per CIS Intune benchmark: Require NTLM and 128-bit encryption."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0\\NTLMMinClientSec Condition: data = '537395216'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0\\NTLMMinClientSec' AND data = '537395216';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:network-security-minimum-session-security-for-ntlmssp-based-clients-is-require-ntlm-and-128-bit-encryption, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Network Security Minimum Session Security For NTLMSSP Based Servers' is set to 'Require NTLM and 128-bit encryption'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Network Security Minimum Session Security For NTLMSSP Based Servers' is set to 'Require NTLM and 128-bit encryption'. Expected state per CIS Intune benchmark: Require NTLM and 128-bit encryption."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0\\NTLMMinServerSec Condition: data = '537395216'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0\\NTLMMinServerSec' AND data = '537395216';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:network, requirement:standard, critical:false, control:network-security-minimum-session-security-for-ntlmssp-based-servers-is-require-ntlm-and-128-bit-encryption, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Network security: Restrict NTLM: Audit Incoming NTLM Traffic' is set to 'Enable auditing for all accounts'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Network security: Restrict NTLM: Audit Incoming NTLM Traffic' is set to 'Enable auditing for all accounts'. Expected state per CIS Intune benchmark: Enable auditing for all accounts."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0\\AuditReceivingNTLMTraffic Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0\\AuditReceivingNTLMTraffic' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:network, requirement:standard, critical:false, control:network-security-restrict-ntlm-audit-incoming-ntlm-traffic-is-enable-auditing-for-all-accounts, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'User Account Control: Behavior of the elevation prompt for administrators' is set to 'Prompt for consent on the secure desktop'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'User Account Control: Behavior of the elevation prompt for administrators' is set to 'Prompt for consent on the secure desktop'. Expected state per CIS Intune benchmark: Prompt for consent on the secure desktop."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\ConsentPromptBehaviorAdmin Condition: data = '2'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\ConsentPromptBehaviorAdmin' AND data = '2';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:user-account-control-behavior-of-the-elevation-prompt-for-administrators-is-prompt-for-consent-on-the-secure-desktop, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'User Account Control: Behavior of the elevation prompt for standard users' is set to 'Automatically deny elevation requests'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'User Account Control: Behavior of the elevation prompt for standard users' is set to 'Automatically deny elevation requests'. Expected state per CIS Intune benchmark: Automatically deny elevation requests."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\ConsentPromptBehaviorUser Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\ConsentPromptBehaviorUser' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:user-account-control-behavior-of-the-elevation-prompt-for-standard-users-is-automatically-deny-elevation-requests, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'User Account Control: Detect application installations and prompt for elevation' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'User Account Control: Detect application installations and prompt for elevation' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableInstallerDetection Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableInstallerDetection' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:user-account-control-detect-application-installations-and-prompt-for-elevation-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'User Account Control: Only elevate UIAccess applications that are installed in secure locations' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'User Account Control: Only elevate UIAccess applications that are installed in secure locations' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableSecureUIAPaths Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableSecureUIAPaths' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:user-account-control-only-elevate-uiaccess-applications-that-are-installed-in-secure-locations-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'User Account Control: Switch to the secure desktop when prompting for elevation' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'User Account Control: Switch to the secure desktop when prompting for elevation' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\PromptOnSecureDesktop Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\PromptOnSecureDesktop' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:authn, requirement:standard, critical:false, control:user-account-control-switch-to-the-secure-desktop-when-prompting-for-elevation-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'User Account Control: Run all administrators in Admin Approval Mode' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'User Account Control: Run all administrators in Admin Approval Mode' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableLUA Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableLUA' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:user-account-control-run-all-administrators-in-admin-approval-mode-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'User Account Control: Virtualize file and registry write failures to per-user locations' is set to 'Enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'User Account Control: Virtualize file and registry write failures to per-user locations' is set to 'Enabled'. Expected state per CIS Intune benchmark: Enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableVirtualization Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableVirtualization' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:user-account-control-virtualize-file-and-registry-write-failures-to-per-user-locations-is-enabled, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Allow Message Sync' is set to 'message sync is not allowed and cannot be changed by the user.'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Allow Message Sync' is set to 'message sync is not allowed and cannot be changed by the user.'. Expected state per CIS Intune benchmark: message sync is not allowed and cannot be changed by the user.."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Messaging\\AllowMessageSync Condition: data = '0'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Messaging\\AllowMessageSync' AND data = '0';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:allow-message-sync-is-message-sync-is-not-allowed-and-cannot-be-changed-by-the-use, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Block Non Admin User Install' is set to 'Allow'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Block Non Admin User Install' is set to 'Allow'. Expected state per CIS Intune benchmark: Allow."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\DisableMSI Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer\\DisableMSI' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:network, requirement:standard, critical:false, control:block-non-admin-user-install-is-allow, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Problem Reports and Solutions Control Panel Support (wercplsupport)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Problem Reports and Solutions Control Panel Support (wercplsupport)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: wercplsupport Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'wercplsupport' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:problem-reports-and-solutions-control-panel-support-wercplsupport-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Remote Desktop Services UserMode Port Redirector (UmRdpService)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Remote Desktop Services UserMode Port Redirector (UmRdpService)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: UmRdpService Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'UmRdpService' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:remote-desktop-services-usermode-port-redirector-umrdpservice-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Windows Media Player Network Sharing Service (WMPNetworkSvc)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Windows Media Player Network Sharing Service (WMPNetworkSvc)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: WMPNetworkSvc Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'WMPNetworkSvc' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:windows-media-player-network-sharing-service-wmpnetworksvc-is-disabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Windows Push Notifications System Service (WpnService)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Windows Push Notifications System Service (WpnService)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: WpnService Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'WpnService' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:windows-push-notifications-system-service-wpnservice-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Windows Remote Management (WS-Management) (WinRM)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Windows Remote Management (WS-Management) (WinRM)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: WinRM Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'WinRM' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:windows-remote-management-ws-management-winrm-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'WinHTTP Web Proxy Auto-Discovery Service (WinHttpAutoProxySvc)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'WinHTTP Web Proxy Auto-Discovery Service (WinHttpAutoProxySvc)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: WinHttpAutoProxySvc Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'WinHttpAutoProxySvc' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:winhttp-web-proxy-auto-discovery-service-winhttpautoproxysvc-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Require UEFI Memory Attributes Table' is set to 'Require UEFI Memory Attributes Table'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Require UEFI Memory Attributes Table' is set to 'Require UEFI Memory Attributes Table'. Expected state per CIS Intune benchmark: Require UEFI Memory Attributes Table."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\System\\RequireUefiMemoryAttributesTable Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\System\\RequireUefiMemoryAttributesTable' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:require-uefi-memory-attributes-table-is-require-uefi-memory-attributes-table, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Enable ESS with Supported Peripherals' is set to 'Enhanced sign-in security will be enabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Enable ESS with Supported Peripherals' is set to 'Enhanced sign-in security will be enabled'. Expected state per CIS Intune benchmark: Enhanced sign-in security will be enabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\PassportForWork\\ESSDevicePeripheralsEnabled Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\PassportForWork\\ESSDevicePeripheralsEnabled' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:enable-ess-with-supported-peripherals-is-enhanced-sign-in-security-will-be-enabled, cis_safeguard_id:CIS4.1
  purpose: Enforcement
- name: CIS - Ensure 'Defer Feature Updates Period in Days' is set to 'Enabled: 180 or more days'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Defer Feature Updates Period in Days' is set to 'Enabled: 180 or more days'. Expected state per CIS Intune benchmark: Enabled: 180 or more days."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\DeferFeatureUpdatesPeriodInDays Condition: data = '180'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\DeferFeatureUpdatesPeriodInDays' AND data = '180';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:configuration, requirement:standard, critical:false, control:defer-feature-updates-period-in-days-is-enabled-180-or-more-days, cis_safeguard_id:CIS7.3
  purpose: Enforcement
- name: CIS - Ensure 'Require PIN For Pairing' is set to 'Enabled: Pairing ceremony for new devices will always require a PIN'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Require PIN For Pairing' is set to 'Enabled: Pairing ceremony for new devices will always require a PIN'. Expected state per CIS Intune benchmark: Enabled: Pairing ceremony for new devices will always require a PIN."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Bluetooth\\RequirePinForPairing Condition: data = '1'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Bluetooth\\RequirePinForPairing' AND data = '1';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:network, requirement:standard, critical:false, control:require-pin-for-pairing-is-enabled-pairing-ceremony-for-new-devices-will-always-require, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Password Complexity' is set to 'Large letters + small letters + numbers + special characters'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Password Complexity' is set to 'Large letters + small letters + numbers + special characters'. Expected state per CIS Intune benchmark: Large letters + small letters + numbers + special characters."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\MinDevicePasswordComplexCharacters Condition: data = '4'"
  query: SELECT 1 FROM registry WHERE path = 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\DeviceLock\\MinDevicePasswordComplexCharacters' AND data = '4';
  tags: framework:CISv8.1, benchmark:win11, level:1, platform:windows, category:authn, requirement:standard, critical:false, control:password-complexity-is-large-letters-small-letters-numbers-special-characters, cis_safeguard_id:CIS6.3
  purpose: Enforcement
- name: CIS - Ensure 'Windows Remote Management (WS- Management) (WinRM)' is set to 'Disabled'
  platform: windows
  description: "Policy checks the configuration for: CIS - Ensure 'Windows Remote Management (WS- Management) (WinRM)' is set to 'Disabled'. Expected state per CIS Intune benchmark: Disabled."
  resolution: "Automatic method: Establish the recommended configuration via Group Policy or Intune configuration profile. Query target: WinRM Condition: start_type = 'DISABLED'"
  query: SELECT 1 FROM services WHERE name = 'WinRM' AND start_type = 'DISABLED';
  tags: framework:CISv8.1, benchmark:win11, level:2, platform:windows, category:configuration, requirement:standard, critical:false, control:windows-remote-management-ws-management-winrm-is-disabled, cis_safeguard_id:CIS7.3
  purpose: Enforcement
